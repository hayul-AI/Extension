<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PixelConvert ‚Äî Free Online Image Converter & OCR</title>
    <meta name="description" content="Convert, compress, and extract text from images instantly. HEIC, JPG, PNG, WEBP, PDF, and OCR tools. No uploads, 100% browser-based.">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/heic2any/0.0.4/heic2any.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/tesseract.js@5/dist/tesseract.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/piexifjs/1.0.6/piexif.min.js"></script>
    <style>
        :root {
            --brand-primary: #6366f1;
            --brand-secondary: #a855f7;
            --brand-accent: #f43f5e;
            --brand-success: #10b981;
            --bg-light: #fdfdfe;
            --bg-dark: #0b0f1a;
            --card-light: rgba(255, 255, 255, 0.7);
            --card-dark: rgba(17, 24, 39, 0.7);
            --border-light: rgba(0, 0, 0, 0.06);
            --border-dark: rgba(255, 255, 255, 0.06);
            --text-main-light: #1e293b;
            --text-main-dark: #f1f5f9;
            --text-sub-light: #64748b;
            --text-sub-dark: #94a3b8;
            --radius-xl: 32px;
            --radius-lg: 20px;
            --shadow-premium: 0 20px 50px -12px rgba(0, 0, 0, 0.1);
            
            /* Theme Text Color System */
            --text-primary: #111111;
            --text-inverse: #ffffff;
            --button-text: #111111;
        }

        [data-theme="dark"] {
            --bg-base: var(--bg-dark);
            --card-base: var(--card-dark);
            --border-base: var(--border-dark);
            --text-main: var(--text-main-dark);
            --text-sub: var(--text-sub-dark);
            --glass-bg: rgba(15, 23, 42, 0.8);
            
            --text-primary: #e5e7eb;
            --text-inverse: #ffffff;
            --button-text: #ffffff;
        }

        [data-theme="light"] {
            --bg-base: var(--bg-light);
            --card-base: var(--card-light);
            --border-base: var(--border-light);
            --text-main: var(--text-main-light);
            --text-sub: var(--text-sub-light);
            --glass-bg: rgba(255, 255, 255, 0.8);
        }

        * { box-sizing: border-box; margin: 0; padding: 0; }

        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: var(--bg-base);
            color: var(--text-main);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
            overflow-x: hidden;
            min-height: 100vh;
            -webkit-font-smoothing: antialiased;
        }

        .ambient-bg {
            position: fixed;
            top: 0; left: 0; width: 100%; height: 100%;
            z-index: -1;
            overflow: hidden;
            background: var(--bg-base);
        }

        .ambient-blob {
            position: absolute;
            width: 60vw; height: 60vw;
            border-radius: 50%;
            filter: blur(120px);
            opacity: 0.15;
            animation: float 30s infinite alternate ease-in-out;
        }

        .blob-1 { top: -10%; left: -10%; background: var(--brand-primary); }
        .blob-2 { bottom: -10%; right: -10%; background: var(--brand-secondary); animation-delay: -10s; }
        .blob-3 { top: 40%; left: 30%; background: var(--brand-accent); animation-duration: 40s; opacity: 0.1; }

        @keyframes float {
            0% { transform: translate(0, 0) rotate(0deg); }
            100% { transform: translate(10vw, 15vh) rotate(120deg); }
        }

        .container {
            width: 95%;
            max-width: 1100px;
            margin: 0 auto;
            padding: 3rem 1.5rem;
        }

        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 6rem;
        }

        .logo-group {
            display: flex; align-items: center; gap: 1rem;
            text-decoration: none; color: inherit;
        }

        .logo-icon {
            width: 44px; height: 44px;
            background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
            border-radius: 12px;
            display: grid; place-items: center;
            color: white;
            box-shadow: 0 8px 16px -4px rgba(99, 102, 241, 0.4);
        }

        .logo-text { font-weight: 800; font-size: 1.5rem; letter-spacing: -0.04em; }

        .theme-toggle {
            padding: 0.75rem 1.5rem;
            background: var(--card-base);
            border: 1px solid var(--border-base);
            border-radius: 16px;
            cursor: pointer;
            font-weight: 700;
            display: flex; align-items: center; gap: 0.75rem;
            backdrop-filter: blur(10px);
            transition: all 0.3s;
            color: var(--button-text) !important;
        }

        .theme-toggle svg,
        .theme-toggle i {
            color: var(--button-text);
            fill: var(--button-text);
        }

        .theme-toggle:hover { transform: translateY(-2px); border-color: var(--brand-primary); }

        .hero { text-align: center; margin-bottom: 6rem; }
        .hero h1 {
            font-size: 4.5rem; font-weight: 800; letter-spacing: -0.06em;
            line-height: 1.2; margin-bottom: 1.5rem; padding-bottom: 0.1em;
            background: linear-gradient(to right, var(--text-main), var(--brand-primary));
            -webkit-background-clip: text; -webkit-text-fill-color: transparent;
        }
        .hero p { font-size: 1.25rem; color: var(--text-sub); max-width: 700px; margin: 0 auto; font-weight: 500; }

        .tabs-container {
            position: sticky; top: 2rem; z-index: 100;
            margin-bottom: 4rem;
            position: relative;
            overflow: visible !important;
        }

        @media (min-width: 768px) {
            .tabs-container::after {
                display: none;
            }
        }

        .tabs-container::after {
            content: "";
            position: absolute;
            top: 0; right: 0;
            width: 60px; height: 100%;
            background: linear-gradient(to right, transparent, var(--bg-base));
            pointer-events: none;
            z-index: 101;
            border-radius: 0 24px 24px 0;
            opacity: 0.8;
        }

        .tabs {
            display: flex !important;
            gap: 0.75rem;
            padding: 0.75rem !important;
            padding-right: 60px !important;
            background: var(--glass-bg);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border: 1px solid var(--border-base);
            border-radius: 28px;
            overflow-x: auto !important;
            overflow-y: hidden !important;
            white-space: nowrap !important;
            flex-wrap: nowrap !important;
            scrollbar-width: none;
            box-shadow: var(--shadow-premium);
            -webkit-overflow-scrolling: touch;
        }
        .tabs::-webkit-scrollbar { display: none; }

        @media (min-width: 768px) {
            .tabs {
                display: grid !important;
                grid-template-columns: repeat(4, 1fr);
                grid-template-rows: auto;
                white-space: normal !important;
                overflow: visible !important;
                padding-right: 0.75rem !important;
            }
        }

        .tab-button {
            flex: 0 0 auto !important;
            padding: 1rem 1.5rem; font-size: 20px; font-weight: 700;
            white-space: nowrap !important; border: none; background: transparent;
            color: var(--text-sub); border-radius: 20px; cursor: pointer;
            transition: all 0.4s cubic-bezier(0.34, 1.56, 0.64, 1);
        }

        @media (min-width: 768px) {
            .tab-button {
                width: 100%;
                padding: 1rem 0.75rem;
            }
        }

        @media (max-width: 768px) {
            .tab-button {
                font-size: 16px;
                padding: 0.8rem 1.25rem;
            }
        }

        .tab-button:hover { 
            color: var(--brand-primary); 
            background: rgba(99, 102, 241, 0.05);
            transform: translateY(-2px);
        }

        .tab-button.active {
            background: var(--brand-primary); 
            color: white;
            font-size: 22px;
            transform: scale(1.05);
            box-shadow: 0 10px 25px -5px rgba(99, 102, 241, 0.4);
            z-index: 1;
        }

        @media (max-width: 768px) {
            .tab-button.active {
                font-size: 18px;
                transform: scale(1.08);
            }
        }

        .tab-content {
            display: none; padding: 4rem;
            background: var(--card-base);
            backdrop-filter: blur(40px);
            -webkit-backdrop-filter: blur(40px);
            border-radius: var(--radius-xl);
            border: 1px solid var(--border-base);
            box-shadow: var(--shadow-premium);
            animation: reveal 0.6s cubic-bezier(0.2, 0.8, 0.2, 1);
        }

        @keyframes reveal {
            from { opacity: 0; transform: translateY(40px) scale(0.96); }
            to { opacity: 1; transform: translateY(0) scale(1); }
        }

        .tab-content.active { display: block; }

        .tool-info {
            margin-top: 4rem;
            border-top: 1px solid var(--border-base);
            padding-top: 3rem;
        }

        .tool-info h3 { font-size: 1.75rem; font-weight: 800; margin-bottom: 1rem; color: var(--brand-primary); }
        .tool-info p { margin-bottom: 1rem; color: var(--text-sub); }
        .tool-steps { margin: 1.5rem 0; padding-left: 1.5rem; }
        .tool-steps li { margin-bottom: 0.5rem; font-weight: 600; color: var(--text-main); }
        
        .faq-block { margin-top: 2rem; }
        .faq-item-small { margin-bottom: 1.5rem; }
        .faq-item-small strong { display: block; margin-bottom: 0.25rem; color: var(--text-main); }
        .faq-item-small span { color: var(--text-sub); font-size: 0.95rem; }

        .privacy-note {
            display: inline-flex; align-items: center; gap: 0.5rem;
            padding: 0.75rem 1.25rem; background: rgba(16, 185, 129, 0.1);
            color: var(--brand-success); border-radius: 12px; font-weight: 700;
            font-size: 0.9rem; margin-top: 1rem;
        }

        /* Resize Tool Preview Viewport & Frame */
        .preview-viewport {
            width: 100%;
            height: 520px;
            height: min(55vh, 520px);
            display: flex;
            align-items: center;
            justify-content: center;
            background: #000;
            border-radius: 24px;
            overflow: hidden;
            position: relative;
            z-index: 10;
        }

        .preview-frame {
            position: relative;
            cursor: grab;
            user-select: none;
            line-height: 0;
            touch-action: none;
            overflow: hidden;
            background: #111;
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
        }

        @media (max-width: 768px) {
            .preview-viewport {
                height: 55vh;
            }
        }

        .drop-zone {
            border: 2px dashed var(--border-base);
            border-radius: var(--radius-lg);
            padding: 5rem 2rem;
            text-align: center;
            transition: all 0.4s;
            cursor: pointer;
            background: rgba(0,0,0,0.01);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
        }

        .drop-zone:hover, .drop-zone.dragover {
            border-color: var(--brand-primary);
            background: rgba(99, 102, 241, 0.03);
            transform: translateY(-4px);
        }

        .btn-primary {
            background: linear-gradient(135deg, var(--brand-primary), var(--brand-secondary));
            color: white; padding: 1rem 2.5rem; border-radius: 16px;
            font-weight: 800; border: none; cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 10px 20px -5px rgba(99, 102, 241, 0.4);
        }

        .btn-primary:hover:not(:disabled) {
            transform: translateY(-2px) scale(1.02);
            filter: brightness(1.1);
            box-shadow: 0 20px 30px -8px rgba(99, 102, 241, 0.5);
        }

        .btn-success {
            width: 100%; padding: 1.25rem; font-size: 1.1rem; font-weight: 800;
            background: linear-gradient(135deg, var(--brand-success), #059669);
            color: white; border: none; border-radius: 18px; cursor: pointer;
            margin-top: 3rem; transition: all 0.3s;
            box-shadow: 0 10px 20px -5px rgba(16, 185, 129, 0.3);
        }

        .btn-success:hover:not(:disabled) { transform: translateY(-2px); filter: brightness(1.05); }

        .progress-wrapper {
            margin-top: 3rem; height: 16px;
            background: var(--border-base); border-radius: 9999px;
            overflow: hidden; display: none;
        }

        .progress-fill {
            width: 0%; height: 100%;
            background: linear-gradient(90deg, var(--brand-primary), var(--brand-secondary));
            transition: width 0.4s ease;
        }

        .results-grid {
            margin-top: 4rem; display: grid; gap: 1.25rem;
        }

        .result-card {
            background: var(--bg-base);
            border: 1px solid var(--border-base);
            padding: 1.5rem; border-radius: 24px;
            display: flex; align-items: center; gap: 1.5rem;
            transition: all 0.3s;
        }

        .result-card:hover { transform: scale(1.02); border-color: var(--brand-primary); }

        /* OCR Comparison Styles */
        .comparison-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: 1.5rem;
            margin-top: 2rem;
        }
        @media (min-width: 992px) {
            .comparison-grid { grid-template-columns: 1fr 1fr; }
        }
        .corrected-panel {
            border: 2px solid var(--brand-primary);
            background: rgba(99, 102, 241, 0.04);
            border-radius: 18px;
            padding: 1.5rem;
            min-height: 300px;
            max-height: 600px;
            overflow-y: auto;
            white-space: pre-wrap;
            line-height: 1.7;
            font-size: 1rem;
            color: var(--text-main);
        }
        .diff-highlight {
            color: #2563eb;
            font-weight: 700;
            background: rgba(37, 99, 235, 0.1);
            padding: 0 2px;
            border-radius: 4px;
            text-decoration: underline;
        }
        .ocr-controls-group {
            display: flex;
            flex-wrap: wrap;
            gap: 0.75rem;
            margin-top: 1.5rem;
        }
        .lang-select {
            padding: 0.75rem 1rem;
            border-radius: 12px;
            border: 1px solid var(--border-base);
            background: var(--bg-base);
            color: var(--text-main);
            font-weight: 700;
            cursor: pointer;
        }

        #ocr-result-area, #ocrResult {
            width: 100%; height: 300px;
            margin-top: 2rem; padding: 1.5rem;
            border-radius: 18px; border: 1px solid var(--border-base);
            background: rgba(0,0,0,0.02); color: var(--text-main);
            font-size: 1rem; line-height: 1.7; resize: vertical;
        }

        .issues-panel {
            margin-top: 1rem;
            padding: 1.5rem;
            background: var(--card-base);
            border: 1px solid var(--brand-accent);
            border-radius: 16px;
            display: none;
        }

        .issue-item {
            margin-bottom: 1rem;
            padding-bottom: 1rem;
            border-bottom: 1px solid var(--border-base);
        }

        .issue-message { font-weight: 700; color: var(--brand-accent); margin-bottom: 0.5rem; }
        .suggestion-btn {
            background: var(--brand-primary);
            color: white;
            border: none;
            padding: 0.4rem 0.8rem;
            border-radius: 8px;
            margin-right: 0.5rem;
            cursor: pointer;
            font-size: 0.85rem;
        }

        .diagnostics-panel {
            margin-top: 2rem;
            padding: 1.5rem;
            background: rgba(0,0,0,0.02);
            border: 1px solid var(--border-base);
            border-radius: 16px;
            display: none;
        }
        .diag-item {
            display: flex; justify-content: space-between; align-items: center;
            padding: 0.5rem 0; border-bottom: 1px solid var(--border-base);
            font-size: 0.9rem;
        }
        .diag-item:last-child { border-bottom: none; }
        .diag-status { font-weight: 800; }

        .faq-grid {
            margin-top: 10rem; display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 2rem;
        }

        .faq-item {
            background: var(--card-base); padding: 2.5rem;
            border-radius: var(--radius-xl); border: 1px solid var(--border-base);
        }

        .faq-item h4 { font-weight: 800; margin-bottom: 1rem; color: var(--brand-primary); }

        footer {
            margin-top: 12rem; padding: 6rem 0; text-align: center;
            border-top: 1px solid var(--border-base);
        }

        .footer-nav { margin-bottom: 3rem; }
        .footer-nav a {
            color: var(--text-sub); text-decoration: none; font-weight: 700;
            margin: 0 1.5rem; transition: color 0.3s;
        }
        .footer-nav a:hover { color: var(--brand-primary); }

        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-track { background: transparent; }
        ::-webkit-scrollbar-thumb { background: var(--border-base); border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: var(--text-sub); }

        @media (max-width: 768px) {
            .hero h1 { font-size: 3rem; }
            .tab-content { padding: 2rem; }
            .hero { margin-bottom: 4rem; }
        }

        /* Palette Ï†ÑÏö© Ïä§ÌÉÄÏùº */
        .palette-instruction {
            text-align: center;
            color: #8b90a0;
            font-size: 14px;
            font-weight: 600;
            margin: 1.5rem 0 -0.5rem 0;
            animation: fadeIn 0.5s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(5px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .history-chip {
            width: 44px; height: 44px;
            border-radius: 12px;
            cursor: pointer;
            border: 3px solid #fff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .history-chip:hover { transform: translateY(-4px) scale(1.1); box-shadow: 0 8px 15px rgba(0,0,0,0.15); }
        #eyedropper-btn:hover { filter: brightness(1.1); transform: translateY(-1px); }
        #picker-container canvas {
            image-rendering: -moz-crisp-edges;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: pixelated;
            image-rendering: optimizeSpeed;
            cursor: crosshair;
        }

        .history-chip {
            width: 44px; height: 44px;
            border-radius: 12px;
            cursor: pointer;
            border: 3px solid #fff;
            box-shadow: 0 4px 10px rgba(0,0,0,0.1);
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }
        .history-chip:hover { transform: translateY(-4px) scale(1.1); box-shadow: 0 8px 15px rgba(0,0,0,0.15); }
        #eyedropper-btn:hover { filter: brightness(1.1); transform: translateY(-1px); }

        /* Resize & Crop Enhancements */
        .resize-toolbar {
            display: flex; gap: 0.5rem; margin-bottom: 1rem; flex-wrap: wrap;
        }
        .tool-toggle {
            background: var(--card-base); border: 1px solid var(--border-base);
            padding: 0.6rem 1.25rem; border-radius: 12px; cursor: pointer;
            font-weight: 700; color: var(--text-main); transition: all 0.2s;
            display: flex; align-items: center; gap: 0.5rem;
        }
        .tool-toggle:hover { background: rgba(99, 102, 241, 0.05); }
        .tool-toggle.active {
            background: var(--brand-primary); color: white; border-color: var(--brand-primary);
        }
        .palette-container {
            display: flex; gap: 0.75rem; margin-top: 1.5rem; flex-wrap: wrap;
            justify-content: center; padding: 1rem; background: rgba(0,0,0,0.02);
            border-radius: 16px;
        }
        .swatch {
            width: 40px; height: 40px; border-radius: 10px; cursor: pointer;
            border: 2px solid white; box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.2s; position: relative;
        }
        .swatch:hover { transform: scale(1.15) translateY(-2px); z-index: 2; }
        .swatch::after {
            content: attr(data-hex); position: absolute; bottom: -20px; left: 50%;
            transform: translateX(-50%); font-size: 10px; font-weight: 800;
            opacity: 0; transition: opacity 0.2s; white-space: nowrap;
        }
        .swatch:hover::after { opacity: 1; }
        
        .brush-controls {
            background: var(--card-base); border: 1px solid var(--border-base);
            padding: 1.25rem; border-radius: 20px; margin-top: 1rem;
            display: none; grid-template-columns: 1fr 1fr; gap: 1.5rem;
            box-shadow: var(--shadow-premium);
        }
        .brush-controls.active { display: grid; }
        .control-group { display: flex; flex-direction: column; gap: 0.5rem; }
        .control-group label { font-size: 0.8rem; font-weight: 800; text-transform: uppercase; opacity: 0.7; }
        
        #pick-info {
            display: none; align-items: center; gap: 1rem; margin-top: 1rem;
            padding: 0.75rem 1.25rem; background: var(--brand-primary);
            color: white; border-radius: 14px; animation: slideIn 0.3s ease;
        }
        @keyframes slideIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        
        .toast {
            position: fixed; bottom: 2rem; left: 50%; transform: translateX(-50%);
            background: #1e293b; color: white; padding: 0.75rem 1.5rem;
            border-radius: 99px; font-weight: 700; z-index: 1000;
            box-shadow: 0 10px 25px rgba(0,0,0,0.2); pointer-events: none;
            opacity: 0; transition: all 0.3s;
        }
        .toast.show { opacity: 1; transform: translateX(-50%) translateY(-10px); }

        /* Filter Editor Scoped Styles */
        .filter-editor-container { margin-top: 2rem; }
        .filter-main-layout { display: flex; flex-direction: column; gap: 2.5rem; }
        @media (min-width: 992px) {
            .filter-main-layout { flex-direction: row; align-items: flex-start; }
            .filter-preview-area { flex: 1.4; position: sticky; top: 2rem; }
            .filter-controls-area { flex: 1; background: var(--card-base); padding: 1.5rem; border-radius: 20px; border: 1px solid var(--border-base); }
        }

        #filter-canvas { max-width: 100%; max-height: 75vh; border-radius: 12px; box-shadow: 0 20px 40px rgba(0,0,0,0.15); display: block; margin: 0 auto; }

        .presets-grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 0.6rem; }
        .preset-btn { 
            padding: 0.75rem 0.5rem; border-radius: 10px; border: 1px solid var(--border-base); 
            background: var(--bg-base); color: var(--text-main); font-size: 0.8rem; font-weight: 700; 
            cursor: pointer; transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1); 
        }
        .preset-btn:hover { border-color: var(--brand-primary); transform: translateY(-2px); }
        .preset-btn.active { background: var(--brand-primary); color: white; border-color: var(--brand-primary); box-shadow: 0 4px 12px rgba(99, 102, 241, 0.3); }

        .slider-group { margin-bottom: 1.5rem; }
        .slider-header { display: flex; justify-content: space-between; margin-bottom: 0.6rem; font-size: 0.85rem; font-weight: 700; }
        .slider-header span { color: var(--brand-primary); font-variant-numeric: tabular-nums; }
        .filter-sliders input[type="range"] { width: 100%; cursor: pointer; accent-color: var(--brand-primary); }

        /* Filter Editor Enhanced Styles */
        #filter-canvas-container {
            width: 100%;
            background: #000;
            border-radius: 12px;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
            position: relative;
            cursor: grab;
            touch-action: none;
            transition: aspect-ratio 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        #filter-canvas-container.ratio-1-1 { aspect-ratio: 1 / 1; }
        #filter-canvas-container.ratio-16-9 { aspect-ratio: 16 / 9; }
        #filter-canvas-container.ratio-9-16 { aspect-ratio: 9 / 16; }
        #filter-canvas-container:active { cursor: grabbing; }
        #filter-canvas {
            max-width: none !important;
            max-height: none !important;
            display: block;
        }
    </style>
    <meta name="naver-site-verification" content="4415f96d8f89974e087dbb0e6da3b5a29f5c2d45" />
</head>
<body data-theme="light">
    <div class="ambient-bg">
        <div class="ambient-blob blob-1"></div>
        <div class="ambient-blob blob-2"></div>
        <div class="ambient-blob blob-3"></div>
    </div>

    <div class="container">
        <header>
            <a href="index.html" class="logo-group">
                <div class="logo-icon">
                    <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path>
                    </svg>
                </div>
                <span class="logo-text">PixelConvert</span>
            </a>
            <div style="display: flex; align-items: center; gap: 1.5rem;">
                <a href="/guides/index.html" style="text-decoration: none; color: var(--text-sub); font-weight: 700; font-size: 0.95rem; transition: color 0.3s;" onmouseover="this.style.color='var(--brand-primary)'" onmouseout="this.style.color='var(--text-sub)'">Guides</a>
                <button class="theme-toggle" id="theme-toggle">
                    <span class="theme-icon">üåô</span>
                    <span class="theme-text">Dark Mode</span>
                </button>
            </div>
        </header>

        <section class="hero">
            <h1>Free Online Image Converter</h1>
            <p>Convert, compress, and extract text from images instantly. No uploads, no registration ‚Äî everything runs in your browser.</p>
        </section>

        <div class="tabs-container">
            <nav class="tabs">
                <button class="tab-button active" data-tab="heic-to-jpg" aria-label="HEIC to JPG Converter">HEIC ‚Üí JPG</button>
                <button class="tab-button" data-tab="webp-to-jpg" aria-label="WEBP to JPG Converter">WEBP ‚Üí JPG</button>
                <button class="tab-button" data-tab="png-to-jpg" aria-label="PNG to JPG Converter">PNG ‚Üí JPG</button>
                <button class="tab-button" data-tab="jpg-to-png" aria-label="JPG to PNG Converter">JPG ‚Üí PNG</button>
                <button class="tab-button" data-tab="compress" aria-label="Image Compressor">Compress</button>
                <button class="tab-button" data-tab="filter" aria-label="Image Filter Editor">Filter</button>
                <button class="tab-button" data-tab="jpg-to-pdf" aria-label="Images to PDF">PDF</button>
                <button class="tab-button" data-tab="favicon" aria-label="Favicon Generator">Favicon</button>
                <button class="tab-button" data-tab="resize-crop" aria-label="Resize and Crop Image">Resize/Crop</button>
                <button class="tab-button" data-tab="exif" aria-label="Remove Image Metadata">EXIF Remover</button>
                <button class="tab-button" data-tab="palette" aria-label="Extract Color Palette">Palette</button>
            </nav>
        </div>

        <main>
            <!-- HEIC Tab -->
            <div id="heic-to-jpg" class="tab-content active">
                <h2>Convert HEIC to JPG</h2>
                <div class="drop-zone">
                    <p style="font-weight: 800; font-size: 1.25rem;">Drop HEIC files here</p>
                    <label class="btn-primary">Select Files</label>
                    <input type="file" class="file-input" multiple accept=".heic, .heif" style="display: none;">
                </div>
                <button class="btn-success convert-button" disabled>Process Images</button>
                <div class="progress-wrapper"><div class="progress-fill"></div></div>
                <div class="results-grid results"></div>
                

                <div class="tool-info">
                    <h3>PixelConvert Image Transformation Suite</h3>
                    <p>PixelConvert provides a comprehensive set of browser-based utilities for common image processing tasks. All operations occur locally on your device, ensuring that your files remain private and are never uploaded to an external server.</p>
                    
                    <div style="margin-top: 2rem;">
                        <ul class="tool-steps">
                            <li style="margin-bottom: 0.75rem;"><strong>HEIC to JPG:</strong> Convert iPhone HEIC and HEIF photos into universally compatible JPG files.</li>
                            <li style="margin-bottom: 0.75rem;"><strong>WEBP to JPG:</strong> Transform modern WEBP web images into standard JPG format.</li>
                            <li style="margin-bottom: 0.75rem;"><strong>PNG to JPG:</strong> Convert PNG graphics into optimized JPGs to reduce file sizes.</li>
                            <li style="margin-bottom: 0.75rem;"><strong>JPG to PNG:</strong> Change JPG photos into lossless PNG format with transparency support.</li>
                            <li style="margin-bottom: 0.75rem;"><strong>Image Compression:</strong> Shrink file sizes while maintaining visible quality.</li>
                            <li style="margin-bottom: 0.75rem;"><strong>Filter Editor:</strong> Apply visual presets and fine-tune image properties locally.</li>
                            <li style="margin-bottom: 0.75rem;"><strong>Resize & Crop:</strong> Adjust pixel dimensions and aspect ratios for social media.</li>
                            <li style="margin-bottom: 0.75rem;"><strong>EXIF Remover:</strong> Protect your privacy by stripping hidden GPS and metadata.</li>
                            <li style="margin-bottom: 0.75rem;"><strong>Image to PDF:</strong> Merge multiple images into a single, organized PDF document.</li>
                            <li style="margin-bottom: 0.75rem;"><strong>Color Palette:</strong> Extract hex codes and dominant colors from any image.</li>
                            <li style="margin-bottom: 0.75rem;"><strong>Favicon Generator:</strong> Create a complete set of web icons from a single logo.</li>
                        </ul>
                    </div>

                    <div style="margin-top: 3rem; border-top: 1px solid var(--border-base); padding-top: 2rem;">
                        <h3 style="font-size: 1.5rem;">How it works</h3>
                        <ul class="tool-steps" style="list-style: none; padding-left: 0;">
                            <li style="margin-bottom: 1rem; display: flex; gap: 1rem;">
                                <span style="background: var(--brand-primary); color: white; width: 28px; height: 28px; border-radius: 50%; display: grid; place-items: center; flex-shrink: 0; font-size: 0.8rem;">1</span>
                                <span>Select or drag and drop your image files into the tool section.</span>
                            </li>
                            <li style="margin-bottom: 1rem; display: flex; gap: 1rem;">
                                <span style="background: var(--brand-primary); color: white; width: 28px; height: 28px; border-radius: 50%; display: grid; place-items: center; flex-shrink: 0; font-size: 0.8rem;">2</span>
                                <span>Adjust specific settings like quality, dimensions, or filters.</span>
                            </li>
                            <li style="margin-bottom: 1rem; display: flex; gap: 1rem;">
                                <span style="background: var(--brand-primary); color: white; width: 28px; height: 28px; border-radius: 50%; display: grid; place-items: center; flex-shrink: 0; font-size: 0.8rem;">3</span>
                                <span>Download the processed results directly to your device instantly.</span>
                            </li>
                        </ul>
                    </div>

                    <div class="faq-block" style="margin-top: 3rem;">
                        <div class="faq-item-small">
                            <strong>Is my image uploaded to a server?</strong>
                            <span>No. All processing occurs locally within your web browser. Your images are never transmitted to, stored on, or seen by any external server.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Will image quality change?</strong>
                            <span>Quality depends on your settings. Lossless conversions maintain clarity, while compression tools balance file size and visual detail.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>What files are supported?</strong>
                            <span>We support most modern formats, including HEIC, HEIF, JPG, JPEG, PNG, and WEBP.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Can I process multiple images?</strong>
                            <span>Yes, most tools support batch processing to handle multiple files efficiently in one session.</span>
                        </div>
                    </div>
                    <div class="privacy-note">PixelConvert prioritizes data security by performing all image processing tasks entirely on your local device.</div>
                </div>
            </div>

            <!-- WEBP Tab -->
            <div id="webp-to-jpg" class="tab-content">
                <h2>Convert WEBP to JPG</h2>
                <div class="drop-zone">
                    <p style="font-weight: 800; font-size: 1.25rem;">Drop WEBP files here</p>
                    <label class="btn-primary">Select Files</label>
                    <input type="file" class="file-input" multiple accept=".webp" style="display: none;">
                </div>
                <button class="btn-success convert-button" disabled>Convert Now</button>
                <div class="progress-wrapper"><div class="progress-fill"></div></div>
                <div class="results-grid results"></div>


                <div class="tool-info">
                    <h3>Fast WEBP to JPG Converter</h3>
                    <p>Convert modern WEBP images back to standard JPG format in seconds. While WEBP is great for the web, JPG remains the standard for editing, printing, and sharing across all software.</p>
                    <p>Our tool uses your browser's hardware acceleration to provide near-instant results even for high-resolution graphics.</p>
                    <ul class="tool-steps">
                        <li>Upload your .webp files from your computer.</li>
                        <li>The tool automatically prepares the standard JPG output.</li>
                        <li>Save the converted images to your local drive.</li>
                    </ul>
                    <div class="faq-block">
                        <div class="faq-item-small">
                            <strong>Why convert WEBP to JPG?</strong>
                            <span>Many older applications and some social media platforms do not fully support the WEBP format.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Is there a file size limit?</strong>
                            <span>Since processing happens locally, the limit depends on your device's RAM, but it easily handles most high-res photos.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Can I use this on mobile?</strong>
                            <span>Yes, PixelConvert is fully responsive and works perfectly on iOS and Android browsers.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Does it cost anything?</strong>
                            <span>No, our converter is 100% free with no hidden subscriptions.</span>
                        </div>
                    </div>
                    <div class="privacy-note">Files are processed locally in your browser. Nothing is uploaded.</div>
                </div>
            </div>

            <!-- PNG Tab -->
            <div id="png-to-jpg" class="tab-content">
                <h2>Convert PNG to JPG</h2>
                <div class="drop-zone">
                    <p style="font-weight: 800; font-size: 1.25rem;">Drop PNG images here</p>
                    <label class="btn-primary">Select Files</label>
                    <input type="file" class="file-input" multiple accept=".png" style="display: none;">
                </div>
                <div class="options" style="margin-top: 3rem;">
                    <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                        <label style="font-weight: 700;">Output Quality</label>
                        <span class="quality-value" style="font-weight: 800; color: var(--brand-primary);">0.92</span>
                    </div>
                    <input type="range" id="png-to-jpg-quality" min="0.1" max="1.0" value="0.92" step="0.01">
                </div>
                <button class="btn-success convert-button" disabled>Generate JPGs</button>
                <div class="progress-wrapper"><div class="progress-fill"></div></div>
                <div class="results-grid results"></div>


                <div class="tool-info">
                    <h3>High-Quality PNG to JPG Converter</h3>
                    <p>Convert transparent PNG images to optimized JPG files. This is perfect for reducing file sizes for web use while maintaining high visual fidelity.</p>
                    <p>You can manually adjust the output quality to find the perfect balance between file size and image clarity.</p>
                    <ul class="tool-steps">
                        <li>Add your PNG images to the converter.</li>
                        <li>Adjust the quality slider if you need a specific file size.</li>
                        <li>Download the resulting JPG images instantly.</li>
                    </ul>
                    <div class="faq-block">
                        <div class="faq-item-small">
                            <strong>What happens to transparency?</strong>
                            <span>Since JPG doesn't support transparency, any transparent areas will be filled with a solid white background.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Does this reduce file size?</strong>
                            <span>Yes, JPG is a lossy format and is typically much smaller than PNG for photographic content.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Can I batch convert?</strong>
                            <span>Yes, you can upload and convert multiple PNGs at once.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Is the quality good?</strong>
                            <span>By setting the slider to 0.9 or higher, you can maintain excellent quality that is indistinguishable from the original.</span>
                        </div>
                    </div>
                    <div class="privacy-note">Files are processed locally in your browser. Nothing is uploaded.</div>
                </div>
            </div>

            <!-- JPG to PNG Tab -->
            <div id="jpg-to-png" class="tab-content">
                 <h2>Convert JPG to PNG</h2>
                <div class="drop-zone">
                    <p style="font-weight: 800; font-size: 1.25rem;">Drop JPG photos here</p>
                    <label class="btn-primary">Select Files</label>
                    <input type="file" class="file-input" multiple accept=".jpg, .jpeg" style="display: none;">
                </div>
                <button class="btn-success convert-button" disabled>Convert to PNG</button>
                <div class="progress-wrapper"><div class="progress-fill"></div></div>
                <div class="results-grid results"></div>


                <div class="tool-info">
                    <h3>Lossless JPG to PNG Converter</h3>
                    <p>Convert JPG photos to PNG format when you need a lossless container for further editing or web development. PNG is the preferred format for graphics that require high precision.</p>
                    <p>This process is entirely client-side, ensuring your private photos never leave your device.</p>
                    <ul class="tool-steps">
                        <li>Select the JPG files you wish to convert.</li>
                        <li>Wait for the local processing to finish.</li>
                        <li>Download your new PNG files one by one or as a pack.</li>
                    </ul>
                    <div class="faq-block">
                        <div class="faq-item-small">
                            <strong>Will the file size increase?</strong>
                            <span>Yes, PNG is usually larger than JPG because it uses lossless compression.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Does this improve the image quality?</strong>
                            <span>No, converting to PNG cannot "restore" detail lost in the original JPG, but it prevents further loss during saving.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Is it free for commercial use?</strong>
                            <span>Yes, PixelConvert is free for all types of usage.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Do I need to register?</strong>
                            <span>No registration or email is required. Just upload and convert.</span>
                        </div>
                    </div>
                    <div class="privacy-note">Files are processed locally in your browser. Nothing is uploaded.</div>
                </div>
            </div>

            <!-- Compress Tab -->
            <div id="compress" class="tab-content">
                <h2>Optimize & Compress</h2>
                <div class="drop-zone">
                    <p style="font-weight: 800; font-size: 1.25rem;">Drop images to shrink</p>
                    <label class="btn-primary">Select Files</label>
                    <input type="file" class="file-input" multiple accept=".jpg, .jpeg, .png, .webp" style="display: none;">
                </div>
                 <div class="options" style="margin-top: 3rem; display: grid; gap: 2rem;">
                    <div>
                        <div style="display: flex; justify-content: space-between; margin-bottom: 1rem;">
                            <label style="font-weight: 700;">Quality Level</label>
                            <span class="quality-value" style="font-weight: 800; color: var(--brand-primary);">0.8</span>
                        </div>
                        <input type="range" id="compress-quality" min="0.4" max="0.95" value="0.8" step="0.01">
                    </div>
                    <div style="display: flex; align-items: center; justify-content: space-between;">
                        <label style="font-weight: 700;">Maximum Width</label>
                        <select id="compress-resize" style="padding: 0.75rem 1rem; border-radius: 12px; border: 1px solid var(--border-base); background: var(--bg-base); color: inherit; font-weight: 700;">
                            <option value="original">Original</option>
                            <option value="1920">1920px (FHD)</option>
                            <option value="1280">1280px (HD)</option>
                            <option value="1080">1080px</option>
                        </select>
                    </div>
                    <div>
                        <label style="font-weight: 700; display: block; margin-bottom: 1rem;">Auto-Target Presets</label>
                        <div style="display: flex; gap: 0.75rem;">
                            <button class="preset-btn" data-target="204800">200KB</button>
                            <button class="preset-btn" data-target="512000">500KB</button>
                            <button class="preset-btn" data-target="1048576">1MB</button>
                            <button class="preset-btn active" data-target="0">Manual</button>
                        </div>
                    </div>
                </div>
                <button class="btn-success convert-button" disabled>Optimize Now</button>
                <div class="progress-wrapper"><div class="progress-fill"></div></div>
                <div class="results-grid results"></div>


                <div class="tool-info">
                    <h3>Smart Image Compressor</h3>
                    <p>Reduce the file size of your images without losing visible quality. Our compressor uses advanced Canvas algorithms to shrink JPG, PNG, and WEBP files for faster website loading and easier email sharing.</p>
                    <p>Use our "Auto-Target" presets to quickly hit specific file size limits (like 200KB or 1MB) required by many government and corporate portals.</p>
                    <ul class="tool-steps">
                        <li>Select multiple images to compress in batch.</li>
                        <li>Choose a target size preset or adjust quality manually.</li>
                        <li>Download the optimized images instantly.</li>
                    </ul>
                    <div class="faq-block">
                        <div class="faq-item-small">
                            <strong>What is "Manual" mode?</strong>
                            <span>Manual mode lets you pick a specific quality percentage (0.1 to 0.95) for the compression.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>How does "Auto-Target" work?</strong>
                            <span>The tool performs a binary search to find the highest quality setting that stays under your chosen file size limit.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Are my original images deleted?</strong>
                            <span>We never have your images. They stay on your computer. Your originals remain untouched in your folders.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Which formats can I compress?</strong>
                            <span>We support JPG, JPEG, PNG, and WEBP compression.</span>
                        </div>
                    </div>
                    <div class="privacy-note">Files are processed locally in your browser. Nothing is uploaded.</div>
                </div>
            </div>

            <!-- Filter Tab -->
            <div id="filter" class="tab-content">
                <h2>Image Filter Editor</h2>
                <div id="filter-upload-stage">
                    <div class="drop-zone">
                        <p style="font-weight: 800; font-size: 1.25rem;">Drop image to filter</p>
                        <label class="btn-primary">Select Image</label>
                        <input type="file" class="file-input" accept="image/*" style="display: none;">
                    </div>
                </div>

                <div id="filter-editor-stage" style="display: none;">
                    <div class="filter-editor-container">
                        <div class="filter-main-layout">
                            <div class="filter-preview-area">
                                <div id="filter-canvas-container">
                                    <canvas id="filter-canvas"></canvas>
                                </div>
                            </div>
                            
                            <div class="filter-controls-area">
                                <div class="edit-controls-row" style="margin-bottom: 2rem; padding-bottom: 2rem; border-bottom: 1px solid var(--border-base);">
                                    <label style="font-weight: 700; display: block; margin-bottom: 1rem;">Canvas & Transform</label>
                                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem; margin-bottom: 1.5rem;">
                                        <div class="control-group">
                                            <label style="font-size: 0.75rem; opacity: 0.7; margin-bottom: 0.4rem; display: block;">Aspect Ratio</label>
                                            <select id="f-ratio" class="lang-select" style="width: 100%;">
                                                <option value="original">Original</option>
                                                <option value="1:1">Square (1:1)</option>
                                                <option value="16:9">Widescreen (16:9)</option>
                                                <option value="9:16">Story (9:16)</option>
                                            </select>
                                        </div>
                                        <div class="control-group">
                                            <label style="font-size: 0.75rem; opacity: 0.7; margin-bottom: 0.4rem; display: block;">Rotation</label>
                                            <div style="display: flex; gap: 0.4rem;">
                                                <button class="preset-btn" id="f-rot-left" style="padding: 0.5rem; flex: 1;">-90¬∞</button>
                                                <button class="preset-btn" id="f-rot-right" style="padding: 0.5rem; flex: 1;">+90¬∞</button>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="slider-group">
                                        <div class="slider-header"><label>Zoom</label><span id="val-zoom">100%</span></div>
                                        <input type="range" id="f-zoom" min="10" max="300" value="100">
                                    </div>
                                    <div class="slider-group" style="margin-bottom: 0;">
                                        <div class="slider-header"><label>Rotate</label><span id="val-rotation">0¬∞</span></div>
                                        <input type="range" id="f-rotation" min="-180" max="180" value="0">
                                    </div>
                                    <div style="display: flex; gap: 0.5rem; margin-top: 1rem;">
                                        <button class="preset-btn" id="f-fit" style="font-size: 0.7rem; flex: 1;">Fit to Screen</button>
                                        <button class="preset-btn" id="f-center" style="font-size: 0.7rem; flex: 1;">Center Image</button>
                                    </div>
                                </div>

                                <div class="filter-presets">
                                    <label style="font-weight: 700; display: block; margin-bottom: 1rem;">Presets</label>
                                    <div class="presets-grid">
                                        <button class="preset-btn active" data-preset="none">None</button>
                                        <button class="preset-btn" data-preset="clean">Clean</button>
                                        <button class="preset-btn" data-preset="warm">Warm</button>
                                        <button class="preset-btn" data-preset="cool">Cool</button>
                                        <button class="preset-btn" data-preset="vintage">Vintage</button>
                                        <button class="preset-btn" data-preset="film">Film</button>
                                        <button class="preset-btn" data-preset="punchy">Punchy</button>
                                        <button class="preset-btn" data-preset="glow">Glow</button>
                                        <button class="preset-btn" data-preset="bw">B&W</button>
                                        <button class="preset-btn" data-preset="sepia">Sepia</button>
                                        <button class="preset-btn" data-preset="dramatic">Dramatic</button>
                                        <button class="preset-btn" data-preset="moody">Moody</button>
                                    </div>
                                </div>

                                <div class="filter-sliders" style="margin-top: 2rem;">
                                    <div class="slider-group">
                                        <div class="slider-header"><label>Brightness</label><span id="val-brightness">100%</span></div>
                                        <input type="range" id="f-brightness" min="0" max="200" value="100">
                                    </div>
                                    <div class="slider-group">
                                        <div class="slider-header"><label>Contrast</label><span id="val-contrast">100%</span></div>
                                        <input type="range" id="f-contrast" min="0" max="200" value="100">
                                    </div>
                                    <div class="slider-group">
                                        <div class="slider-header"><label>Saturation</label><span id="val-saturation">100%</span></div>
                                        <input type="range" id="f-saturation" min="0" max="200" value="100">
                                    </div>
                                    <div class="slider-group">
                                        <div class="slider-header"><label>Blur</label><span id="val-blur">0px</span></div>
                                        <input type="range" id="f-blur" min="0" max="20" value="0">
                                    </div>
                                    <div class="slider-group">
                                        <div class="slider-header"><label>Vignette</label><span id="val-vignette">0%</span></div>
                                        <input type="range" id="f-vignette" min="0" max="100" value="0">
                                    </div>
                                    <div class="slider-group">
                                        <div class="slider-header"><label>Grain</label><span id="val-grain">0%</span></div>
                                        <input type="range" id="f-grain" min="0" max="100" value="0">
                                    </div>
                                </div>

                                <div class="filter-actions" style="margin-top: 2rem; display: flex; gap: 1rem;">
                                    <button class="btn-success" id="filter-download-btn" style="flex: 2; padding: 1rem; border-radius: 12px; font-weight: 800;">Download PNG</button>
                                    <button class="btn-primary" id="filter-reset-btn" style="flex: 1; background: var(--text-sub); box-shadow: none;">Reset</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="tool-info">
                    <h3>Free Professional Image Filter Editor</h3>
                    <p>Enhance your photos instantly with our high-performance image filter tool. Apply professional presets or fine-tune individual settings like brightness, contrast, and saturation. Everything is processed locally in your browser for maximum privacy and speed.</p>
                    <ul class="tool-steps">
                        <li>Upload any image file (up to 10MB).</li>
                        <li>Choose a preset or adjust the sliders for a custom look.</li>
                        <li>Download your high-quality filtered image instantly.</li>
                    </ul>
                    <div class="privacy-note">Files are processed locally in your browser. Nothing is uploaded.</div>
                </div>
            </div>

            <!-- PDF Tab -->
            <div id="jpg-to-pdf" class="tab-content">
                <h2>Merge to PDF</h2>
                <div class="drop-zone">
                    <p style="font-weight: 800; font-size: 1.25rem;">Drop images to merge</p>
                    <label class="btn-primary">Select Files</label>
                    <input type="file" class="file-input" multiple accept=".jpg, .jpeg" style="display: none;">
                </div>
                <button class="btn-success convert-button" disabled>Create Document</button>
                <div class="progress-wrapper"><div class="progress-fill"></div></div>
                <div class="results-grid results"></div>


                <div class="tool-info">
                    <h3>Professional Images to PDF Converter</h3>
                    <p>Combine multiple JPG images into a single, high-quality PDF document. This is ideal for creating digital portfolios, submitting assignments, or organizing scanned receipts into a single file.</p>
                    <p>Our PDF generator ensures that image quality is maintained while keeping the document size manageable for sharing and archiving.</p>
                    <ul class="tool-steps">
                        <li>Upload all the images you want to merge into a single PDF.</li>
                        <li>The tool automatically scales them to a standard A4 page layout.</li>
                        <li>Download the merged PDF document instantly.</li>
                    </ul>
                    <div class="faq-block">
                        <div class="faq-item-small">
                            <strong>Can I reorder images?</strong>
                            <span>Currently, images are added in the order you select them. For specific ordering, upload them in groups.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Is there a page limit?</strong>
                            <span>The tool can handle dozens of pages, limited only by your browser's available memory.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Are the PDFs searchable?</strong>
                            <span>The resulting PDF contains images. To make it searchable, you would need to run it through an OCR process.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Can I merge PNG files too?</strong>
                            <span>Currently, this tool is optimized for JPG and JPEG files.</span>
                        </div>
                    </div>
                    <div class="privacy-note">Files are processed locally in your browser. Nothing is uploaded.</div>
                </div>
            </div>

            <!-- Favicon Tab -->
            <div id="favicon" class="tab-content">
                 <h2>Favicon Generator</h2>
                <div class="drop-zone">
                    <p style="font-weight: 800; font-size: 1.25rem;">Drop your logo</p>
                    <label class="btn-primary">Select Image</label>
                    <input type="file" class="file-input" accept=".png, .jpg, .jpeg" style="display: none;">
                </div>
                <button class="btn-success convert-button" disabled>Generate Pack</button>
                <div class="progress-wrapper"><div class="progress-fill"></div></div>
                <div class="results-grid results"></div>


                <div class="tool-info">
                    <h3>Free Favicon Generator</h3>
                    <p>Convert your brand logo into a complete set of favicons for your website. A favicon is the small icon that appears in browser tabs and bookmarks, essential for a professional web presence.</p>
                    <p>Our generator creates standard sizes (16x16, 32x32, etc.) and bundles them into a convenient ZIP pack for easy deployment.</p>
                    <ul class="tool-steps">
                        <li>Upload a square logo image (PNG or JPG).</li>
                        <li>Wait for the tool to generate the multiple required sizes.</li>
                        <li>Download the ZIP pack containing all your new favicons.</li>
                    </ul>
                    <div class="faq-block">
                        <div class="faq-item-small">
                            <strong>What is the best starting resolution?</strong>
                            <span>We recommend using a 512x512 PNG image for the best results across all sizes.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Which formats are in the ZIP pack?</strong>
                            <span>The pack contains standard .png files in 16x16, 32x32, 48x48, and 64x64 resolutions.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Do I need to pay for the ZIP pack?</strong>
                            <span>No, like all PixelConvert tools, the favicon generator is completely free.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Is a square image required?</strong>
                            <span>Yes, favicons are always square. Non-square images will be scaled to fit.</span>
                        </div>
                    </div>
                    <div class="privacy-note">Files are processed locally in your browser. Nothing is uploaded.</div>
                </div>
            </div>

            <!-- Resize & Crop Tab -->
            <div id="resize-crop" class="tab-content">
                <h2>Resize & Center Crop</h2>
                
                <div id="resize-main-container" style="position: relative; margin-bottom: 2rem;">
                    <!-- Drop Zone View -->
                    <div class="drop-zone" id="resize-drop-zone" style="min-height: 450px;">
                        <p style="font-weight: 800; font-size: 1.25rem; color: var(--text-sub);">Drop image to start editing</p>
                        <label class="btn-primary">Select Image</label>
                        <input type="file" class="file-input" accept="image/png, image/jpeg, image/webp" style="display: none;">
                    </div>

                    <!-- Enhanced Preview View (Viewport) -->
                    <div id="resize-preview-container" class="preview-viewport" style="display: none;">
                        <div id="resize-workspace" class="preview-frame">
                            <!-- Top Toolbar -->
                            <div class="resize-toolbar" style="position: absolute; top: 1rem; left: 1rem; right: 1rem; z-index: 100; display: flex; justify-content: space-between; align-items: center; pointer-events: none;">
                                <div style="display: flex; gap: 0.5rem; pointer-events: auto;">
                                    <button class="tool-toggle active" id="tool-pan" title="Move & Zoom">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M5 9l-3 3 3 3M9 5l3-3 3 3M15 19l-3 3-3-3M19 9l3 3-3 3M2 12h20M12 2v20"/></svg>
                                        <span>Pan</span>
                                    </button>
                                    <button class="tool-toggle" id="tool-pick" title="Pick Color">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"/></svg>
                                        <span>Pick</span>
                                    </button>
                                    <button class="tool-toggle" id="tool-mosaic" title="Paint Mosaic">
                                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
                                        <span>Mosaic</span>
                                    </button>
                                </div>
                                
                                <button id="resize-change-img" style="pointer-events: auto; background: rgba(255,255,255,0.2); border: none; color: #fff; padding: 0.5rem; border-radius: 50%; width: 36px; height: 32px; display: flex; align-items: center; justify-content: center; cursor: pointer; backdrop-filter: blur(8px); transition: all 0.2s;">
                                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><line x1="18" y1="6" x2="6" y2="18"></line><line x1="6" y1="6" x2="18" y2="18"></line></svg>
                                </button>
                            </div>

                            <!-- Main Preview Canvas -->
                            <canvas id="resize-preview-canvas" style="width: 100%; height: 100%; cursor: grab; touch-action: none; display: block;"></canvas>
                            
                            <!-- Pick Info Overlay -->
                            <div id="pick-info" style="position: absolute; top: 4.5rem; left: 1rem; z-index: 90; pointer-events: auto;">
                                <div id="pick-color-chip" style="width: 24px; height: 24px; border-radius: 6px; border: 2px solid white;"></div>
                                <span id="pick-hex" style="font-family: monospace; font-weight: 800; font-size: 0.9rem;">#FFFFFF</span>
                                <button id="pick-copy-btn" style="background: none; border: none; color: white; cursor: pointer; padding: 2px;"><svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="3"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg></button>
                            </div>

                            <!-- Zoom Controls -->
                            <div id="resize-zoom-controls" style="position: absolute; bottom: 1.5rem; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.7); backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); padding: 0.75rem 1.25rem; border-radius: 99px; display: flex; align-items: center; gap: 1rem; color: #fff; width: 90%; max-width: 340px; border: 1px solid rgba(255,255,255,0.15); box-shadow: 0 10px 30px rgba(0,0,0,0.5); z-index: 100;">
                                <span style="font-size: 0.7rem; font-weight: 800; text-transform: uppercase; letter-spacing: 0.1em; opacity: 0.8;">Zoom</span>
                                <input type="range" id="resize-zoom-slider" min="1" max="5" step="0.001" value="1" style="flex-grow: 1; accent-color: var(--brand-primary); cursor: pointer; height: 4px;">
                                <button id="resize-reset-btn" style="background: rgba(255,255,255,0.2); border: none; color: #fff; font-weight: 800; font-size: 0.65rem; padding: 0.4rem 0.8rem; border-radius: 6px; cursor: pointer; white-space: nowrap; transition: all 0.2s;">RESET</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Mosaic Brush Controls -->
                <div class="brush-controls" id="mosaic-controls">
                    <div class="control-group">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <label>Brush Size</label>
                            <span id="brush-size-val" style="font-weight: 800; color: var(--brand-primary); font-size: 0.8rem;">40px</span>
                        </div>
                        <input type="range" id="brush-size" min="10" max="150" value="40" style="accent-color: var(--brand-primary);">
                    </div>
                    <div class="control-group">
                        <div style="display: flex; justify-content: space-between; align-items: center;">
                            <label>Mosaic Size</label>
                            <span id="mosaic-strength-val" style="font-weight: 800; color: var(--brand-primary); font-size: 0.8rem;">15px</span>
                        </div>
                        <input type="range" id="mosaic-strength" min="5" max="50" value="15" style="accent-color: var(--brand-primary);">
                    </div>
                    <div style="grid-column: span 2; display: flex; gap: 0.75rem;">
                        <button class="btn-primary" id="mosaic-undo" style="flex: 1; padding: 0.6rem; font-size: 0.8rem; background: var(--text-sub); box-shadow: none;">Undo</button>
                        <button class="btn-primary" id="mosaic-clear" style="flex: 1; padding: 0.6rem; font-size: 0.8rem; background: var(--brand-accent); box-shadow: none;">Clear Mosaic</button>
                    </div>
                </div>

                <!-- Palette Extraction View -->
                <div id="extracted-palette" style="display: none; margin-top: 1.5rem;">
                    <label style="font-weight: 800; font-size: 0.8rem; text-transform: uppercase; opacity: 0.6; display: block; text-align: center;">Extracted Image Palette</label>
                    <div class="palette-container" id="palette-swatches"></div>
                </div>

                <div class="options" style="margin-top: 3rem; display: grid; gap: 2rem;">
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 1rem;">
                        <div>
                            <label style="font-weight: 700; display: block; margin-bottom: 0.5rem;">Target Width (px)</label>
                            <input type="number" id="targetWidth" value="1080" style="width: 100%; padding: 0.75rem; border-radius: 12px; border: 1px solid var(--border-base); background: var(--bg-base); color: inherit;">
                        </div>
                        <div>
                            <label style="font-weight: 700; display: block; margin-bottom: 0.5rem;">Target Height (px)</label>
                            <input type="number" id="targetHeight" value="1080" style="width: 100%; padding: 0.75rem; border-radius: 12px; border: 1px solid var(--border-base); background: var(--bg-base); color: inherit;">
                        </div>
                    </div>
                    <div>
                        <label style="font-weight: 700; display: block; margin-bottom: 1rem;">Presets & Aspect Ratio</label>
                        <div style="display: flex; flex-wrap: wrap; gap: 0.75rem;">
                            <button class="preset-btn" onclick="window.applyResizePreset(1280, 720)">HD (16:9)</button>
                            <button class="preset-btn" onclick="window.applyResizePreset(1080, 1080)">Square (1:1)</button>
                            <button class="preset-btn" onclick="window.applyResizePreset(1080, 1920)">Story (9:16)</button>
                        </div>
                    </div>
                    <div style="display: flex; align-items: center; gap: 1.5rem;">
                        <label style="font-weight: 700;">Format:</label>
                        <select id="resize-format" style="padding: 0.5rem 1rem; border-radius: 10px; border: 1px solid var(--border-base); background: var(--bg-base); color: inherit;">
                            <option value="image/jpeg">JPG</option>
                            <option value="image/png">PNG</option>
                        </select>
                    </div>
                </div>
                <button class="btn-success convert-button" disabled>Apply & Download</button>
                <div class="results-grid results"></div>

                <div class="tool-info">
                    <h3>Smart Image Resizer & Center Cropper</h3>
                    <p>Perfectly resize and crop your images for social media, profile pictures, or web content. Our tool intelligently focuses on the center of your image to ensure the most important subject remains in frame while meeting your exact pixel dimensions.</p>
                    <p>Whether you need a square 1:1 post, a 16:9 HD thumbnail, or a custom resolution, our browser-based engine processes everything locally, maintaining high visual fidelity without data usage.</p>
                    <ul class="tool-steps">
                        <li>Upload your image (JPG, PNG, or WEBP).</li>
                        <li>Enter your target width and height or select a preset.</li>
                        <li>The tool automatically center-crops and resizes to fit.</li>
                        <li>Download your perfectly framed image instantly.</li>
                    </ul>
                    <div class="faq-block">
                        <div class="faq-item-small">
                            <strong>What is center-cropping?</strong>
                            <span>It's a technique that takes the middle portion of your image to fit a specific aspect ratio, preventing "stretching" or distortion.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Can I choose the crop area?</strong>
                            <span>This tool is optimized for fast, automatic center-focus. For manual adjustment, keep the subject centered before uploading.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Does it support transparent PNGs?</strong>
                            <span>Yes, resizing preserves transparency if you choose the PNG output format.</span>
                        </div>
                    </div>
                    <div class="privacy-note">Files are processed locally in your browser. Nothing is uploaded.</div>
                </div>
            </div>

            <!-- EXIF Remover Tab -->
            <div id="exif" class="tab-content">
                <h2>Privacy (Metadata Remover)</h2>
                <div class="drop-zone">
                    <p>Drop JPG to strip metadata</p>
                    <label class="btn-primary">Select JPG</label>
                    <input type="file" class="file-input" accept="image/jpeg" style="display: none;">
                </div>
                <div style="margin-top: 2rem; padding: 1.5rem; background: rgba(244, 63, 94, 0.1); border-radius: 16px; color: var(--brand-accent); font-weight: 600;">
                    ‚ö†Ô∏è This tool will permanently remove GPS location, camera model, and creation date from your image to protect your privacy.
                </div>
                <button class="btn-success convert-button" disabled>Strip Metadata</button>
                <div class="results-grid results"></div>

                <div class="tool-info">
                    <h3>Professional EXIF & Metadata Remover</h3>
                    <p>Protect your digital footprint by stripping sensitive hidden data from your photos. Every JPG you take contains "EXIF" data‚Äîhidden information that can reveal your exact GPS coordinates, camera serial number, and exact time of capture.</p>
                    <p>Our metadata scrubber deep-cleans your files by removing these tags entirely, ensuring that when you share a photo online, you only share the image, not your location or privacy.</p>
                    <ul class="tool-steps">
                        <li>Select the JPG photos you want to anonymize.</li>
                        <li>Our engine identifies and strips all GPS and technical tags.</li>
                        <li>The process is instant and happens entirely on your device.</li>
                        <li>Download "cleaned" versions of your photos for safe sharing.</li>
                    </ul>
                    <div class="faq-block">
                        <div class="faq-item-small">
                            <strong>What data is actually removed?</strong>
                            <span>We remove GPS coordinates, device models, software info, and timestamps (Date/Time Original).</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Does this reduce image quality?</strong>
                            <span>No. We only remove the text-based metadata headers; the actual pixel data remains untouched.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Why only JPG?</strong>
                            <span>JPG is the most common format for EXIF metadata. We are working on supporting other formats soon.</span>
                        </div>
                    </div>
                    <div class="privacy-note">Files are processed locally in your browser. Nothing is uploaded.</div>
                </div>
            </div>

            <!-- Palette Tab -->
            <div id="palette" class="tab-content">
                <h2>Color Picker (Dropper)</h2>
                <div class="drop-zone">
                    <p style="font-weight: 800; font-size: 1.25rem;">Drop image to pick colors</p>
                    <label class="btn-primary">Select Image</label>
                    <input type="file" class="file-input" accept="image/*" style="display: none;">
                </div>
                
                <div id="eyedropper-container" style="display: none; margin-top: 1.5rem; text-align: center;">
                    <button id="eyedropper-btn" class="btn-primary" style="background: var(--text-main); color: var(--bg-base); box-shadow: none;">
                        <span style="margin-right: 8px;">üé®</span> Use System Eyedropper
                    </button>
                </div>

                <div id="palette-workspace" style="display:none; margin-top: 2rem;">
                    <!-- Canvas & Loupe Container -->
                    <div id="picker-container" style="position: relative; cursor: crosshair; user-select: none; line-height: 0; touch-action: none; overflow: hidden; border-radius: 16px; box-shadow: var(--shadow-lg);">
                        <canvas id="palette-canvas" style="max-width: 100%; height: auto; display: block;"></canvas>
                        
                        <!-- Loupe (ÌôïÎåÄÍ≤Ω) -->
                        <div id="loupe" style="position: absolute; pointer-events: none; display: none; width: 140px; height: 140px; border-radius: 50%; border: 4px solid #fff; box-shadow: 0 0 25px rgba(0,0,0,0.4); overflow: hidden; z-index: 100; transform: translate(-50%, -120%);">
                            <canvas id="loupe-canvas" width="140" height="140" style="image-rendering: pixelated;"></canvas>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 2px; height: 12px; background: rgba(255,0,0,0.8);"></div>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 12px; height: 2px; background: rgba(255,0,0,0.8);"></div>
                            <div id="loupe-hex" style="position: absolute; bottom: 12px; left: 50%; transform: translateX(-50%); background: rgba(0,0,0,0.75); color: #fff; padding: 3px 8px; border-radius: 6px; font-size: 11px; font-family: 'JetBrains Mono', monospace; font-weight: 700; border: 1px solid rgba(255,255,255,0.2);"></div>
                        </div>
                    </div>

                    <!-- ÏïàÎÇ¥ Î¨∏Íµ¨ Ï∂îÍ∞Ä -->
                    <p class="palette-instruction">
                        Click a color to copy the HEX code automatically
                    </p>

                    <!-- Selection Info -->
                    <div id="selection-info" style="margin-top: 2rem; display: flex; align-items: center; gap: 1.5rem; padding: 1.5rem; background: var(--bg-card); border-radius: 20px; border: 1px solid #eee;">
                        <div id="current-color-chip" style="width: 80px; height: 80px; border-radius: 16px; border: 4px solid #fff; box-shadow: var(--shadow-md); background: #eee;"></div>
                        <div style="flex-grow: 1;">
                            <label style="display: block; font-size: 0.85rem; font-weight: 800; color: var(--text-sub); margin-bottom: 0.5rem; text-transform: uppercase;">Selected Color</label>
                            <div style="display: flex; gap: 0.75rem;">
                                <input type="text" id="selected-hex" readonly value="#------" style="font-family: 'JetBrains Mono', monospace; font-weight: 800; font-size: 1.5rem; border: none; background: transparent; padding: 0; color: var(--text-main); width: 140px;">
                                <button class="btn-primary" id="copy-hex-btn" style="padding: 0.5rem 1rem; font-size: 0.85rem; box-shadow: none;">Copy HEX</button>
                            </div>
                        </div>
                    </div>

                    <!-- History -->
                    <div style="margin-top: 2rem;">
                        <h4 style="margin-bottom: 1rem; font-weight: 800;">Recent Colors</h4>
                        <div id="color-history" style="display: flex; flex-wrap: wrap; gap: 0.75rem;">
                            <!-- History chips go here -->
                        </div>
                    </div>
                </div>

                <div class="tool-info">
                    <h3>Precision Image Color Picker & Dropper</h3>
                    <p>Extract the exact HEX color codes from any image or photograph. This tool acts as a virtual eyedropper, allowing you to sample colors from your brand assets, UI designs, or inspiring photos with pixel-perfect accuracy.</p>
                    <p>Designed for designers and developers, it provides instant HEX conversion and maintains a local history of your recently picked shades, making it easy to build a cohesive color palette for your next project.</p>
                    <ul class="tool-steps">
                        <li>Upload an image to open the color workspace.</li>
                        <li>Hover and click on any pixel to capture its color.</li>
                        <li>Use the zoom loupe for precise selection of fine details.</li>
                        <li>Click "Copy HEX" to save the code to your clipboard.</li>
                    </ul>
                    <div class="faq-block">
                        <div class="faq-item-small">
                            <strong>How accurate is the color picking?</strong>
                            <span>It uses raw Canvas getImageData, providing 100% accurate RGB-to-HEX values from the original file.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>What is the average color (Shift+Click)?</strong>
                            <span>By holding Shift, you can sample a 5x5 area to get a smoother, averaged color instead of a single noisy pixel.</span>
                        </div>
                        <div class="faq-item-small">
                            <strong>Does it save my history?</strong>
                            <span>Yes, your last 6 selections are stored temporarily in your browser session for quick reference.</span>
                        </div>
                    </div>
                    <div class="privacy-note">Files are processed locally in your browser. Nothing is uploaded.</div>
                </div>
                
                <button class="btn-success convert-button" disabled style="display: none;">Extract Palette</button>
            </div>

        </main>

        <section class="faq-grid">
            <div class="faq-item">
                <h4>Ironclad Privacy</h4>
                <p>By leveraging WebAssembly and the Canvas API, we ensure your files never leave your computer. Privacy isn't a feature; it's our foundation.</p>
            </div>
            <div class="faq-item">
                <h4>Lightning Speed</h4>
                <p>No network latency. Batch process dozens of high-res photos in seconds with optimized local algorithms.</p>
            </div>
            <div class="faq-item">
                <h4>Always Free</h4>
                <p>No subscriptions, no watermarks, no registration. Professional tools accessible to everyone, anywhere.</p>
            </div>
        </section>

        <footer>
            <nav class="footer-nav">
                <a href="about.html">About</a>
                <a href="guides/index.html">Guides</a>
                <a href="privacy.html">Privacy</a>
                <a href="terms.html">Terms</a>
                <a href="contact.html">Contact</a>
            </nav>
            <p style="font-size: 0.95rem; color: var(--text-sub); font-weight: 600;">¬© 2026 PixelConvert. Built for privacy.</p>
        </footer>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const themeToggle = document.getElementById('theme-toggle');
        const themeIcon = themeToggle.querySelector('.theme-icon');
        const themeText = themeToggle.querySelector('.theme-text');
        const body = document.body;

        const savedTheme = localStorage.getItem('theme') || 'light';
        setTheme(savedTheme);

        themeToggle.addEventListener('click', () => {
            const currentTheme = body.getAttribute('data-theme');
            setTheme(currentTheme === 'light' ? 'dark' : 'light');
        });

        function setTheme(theme) {
            body.setAttribute('data-theme', theme);
            localStorage.setItem('theme', theme);
            themeIcon.textContent = theme === 'dark' ? '‚òÄÔ∏è' : 'üåô';
            themeText.textContent = theme === 'dark' ? 'Light Mode' : 'Dark Mode';
        }

        const JSZip = window.JSZip;
        const { jsPDF } = window.jspdf;
        const fileStore = new Map();
        let currentTargetSize = 0;
        let ocrWorker = null; // Cached OCR worker

        // Resize & Center Crop State
        let resizeState = {
            img: null,
            zoom: 1,
            x: 0,
            y: 0,
            isDragging: false,
            lastX: 0,
            lastY: 0,
            canvas: document.getElementById('resize-preview-canvas'),
            ctx: document.getElementById('resize-preview-canvas').getContext('2d'),
            targetW: 1080,
            targetH: 1080,
            displayW: 0,
            displayH: 0,
            baseScale: 1
        };

        window.applyResizePreset = (w, h) => {
            const widthInput = document.getElementById('targetWidth');
            const heightInput = document.getElementById('targetHeight');
            if (widthInput && heightInput) {
                widthInput.value = w;
                heightInput.value = h;
                resizeState.targetW = w;
                resizeState.targetH = h;
                updateResizePreview();
            }
        };

        function updateResizePreview() {
            if (!resizeState.img) return;
            const { canvas, ctx, img, zoom, targetW, targetH } = resizeState;
            
            // Calculate display dimensions based on viewport
            const viewport = document.getElementById('resize-preview-container');
            const workspace = document.getElementById('resize-workspace');
            
            const vW = viewport.clientWidth;
            const vH = viewport.clientHeight;
            const ratio = targetW / targetH;

            let displayW, displayH;
            if (vW / vH > ratio) {
                // Viewport is wider than aspect ratio
                displayH = vH;
                displayW = displayH * ratio;
            } else {
                // Viewport is taller than aspect ratio
                displayW = vW;
                displayH = displayW / ratio;
            }
            
            // Apply dimensions to frame
            workspace.style.width = displayW + 'px';
            workspace.style.height = displayH + 'px';

            resizeState.displayW = displayW;
            resizeState.displayH = displayH;

            // Adjust canvas resolution for high DPI
            const dpr = window.devicePixelRatio || 1;
            canvas.width = displayW * dpr;
            canvas.height = displayH * dpr;
            canvas.style.width = displayW + 'px';
            canvas.style.height = displayH + 'px';
            ctx.scale(dpr, dpr);
            
            ctx.fillStyle = '#000';
            ctx.fillRect(0, 0, displayW, displayH);
            
            // Base scale to cover the frame
            const baseScale = Math.max(displayW / img.width, displayH / img.height);
            resizeState.baseScale = baseScale;
            const s = baseScale * zoom;
            
            // Clamp position to ensure image always covers frame
            const minX = displayW - img.width * s;
            const minY = displayH - img.height * s;
            
            if (resizeState.x > 0) resizeState.x = 0;
            if (resizeState.y > 0) resizeState.y = 0;
            if (resizeState.x < minX) resizeState.x = minX;
            if (resizeState.y < minY) resizeState.y = minY;
            
            ctx.imageSmoothingEnabled = true;
            ctx.imageSmoothingQuality = 'high';
            ctx.drawImage(img, resizeState.x, resizeState.y, img.width * s, img.height * s);
            
            // Indicators
            ctx.strokeStyle = 'rgba(255,255,255,0.3)';
            ctx.lineWidth = 1;
            ctx.strokeRect(0.5, 0.5, displayW - 1, displayH - 1);
        }

        function initResizePreview(file) {
            const container = document.getElementById('resize-preview-container');
            const dropZone = document.getElementById('resize-drop-zone');
            const slider = document.getElementById('resize-zoom-slider');
            const img = new Image();
            img.onload = () => {
                resizeState.img = img;
                resizeState.zoom = 1;
                resizeState.targetW = parseInt(document.getElementById('targetWidth').value) || 1080;
                resizeState.targetH = parseInt(document.getElementById('targetHeight').value) || 1080;
                
                dropZone.style.display = 'none';
                container.style.display = 'flex';
                slider.value = 1;
                
                // First pass to set display dimensions
                updateResizePreview();
                
                // Initial centered position
                const s = Math.max(resizeState.displayW / img.width, resizeState.displayH / img.height);
                resizeState.x = (resizeState.displayW - img.width * s) / 2;
                resizeState.y = (resizeState.displayH - img.height * s) / 2;
                
                // Second pass to draw image
                updateResizePreview();
            };
            img.src = URL.createObjectURL(file);
        }

        // Event Listeners for Resize Preview
        const resizeCanvas = document.getElementById('resize-preview-canvas');
        const resizeSlider = document.getElementById('resize-zoom-slider');
        const resizeResetBtn = document.getElementById('resize-reset-btn');
        const resizeChangeImgBtn = document.getElementById('resize-change-img');

        resizeCanvas.addEventListener('pointerdown', e => {
            if (!resizeState.img) return;
            resizeState.isDragging = true;
            resizeState.lastX = e.clientX;
            resizeState.lastY = e.clientY;
            resizeCanvas.style.cursor = 'grabbing';
            resizeCanvas.setPointerCapture(e.pointerId);
        });

        resizeCanvas.addEventListener('pointermove', e => {
            if (!resizeState.isDragging) return;
            const dx = e.clientX - resizeState.lastX;
            const dy = e.clientY - resizeState.lastY;
            resizeState.x += dx;
            resizeState.y += dy;
            resizeState.lastX = e.clientX;
            resizeState.lastY = e.clientY;
            updateResizePreview();
        });

        resizeCanvas.addEventListener('pointerup', () => {
            resizeState.isDragging = false;
            resizeCanvas.style.cursor = 'grab';
        });

        resizeCanvas.addEventListener('wheel', e => {
            if (!resizeState.img) return;
            e.preventDefault();
            
            const rect = resizeCanvas.getBoundingClientRect();
            const px = e.clientX - rect.left;
            const py = e.clientY - rect.top;
            
            const delta = e.deltaY > 0 ? 0.9 : 1.1;
            const oldZoom = resizeState.zoom;
            const newZoom = Math.max(1, Math.min(10, oldZoom * delta));
            
            if (oldZoom !== newZoom) {
                const s = resizeState.baseScale * oldZoom;
                const newS = resizeState.baseScale * newZoom;
                
                // Zoom around cursor
                const ix = (px - resizeState.x) / s;
                const iy = (py - resizeState.y) / s;
                
                resizeState.x = px - ix * newS;
                resizeState.y = py - iy * newS;
                resizeState.zoom = newZoom;
                resizeSlider.value = newZoom;
                updateResizePreview();
            }
        }, { passive: false });

        resizeSlider.addEventListener('input', e => {
            const oldZoom = resizeState.zoom;
            const newZoom = parseFloat(e.target.value);
            
            // Zoom around center of frame when using slider
            const px = resizeState.displayW / 2;
            const py = resizeState.displayH / 2;
            
            const s = resizeState.baseScale * oldZoom;
            const newS = resizeState.baseScale * newZoom;
            
            const ix = (px - resizeState.x) / s;
            const iy = (py - resizeState.y) / s;
            
            resizeState.x = px - ix * newS;
            resizeState.y = py - iy * newS;
            resizeState.zoom = newZoom;
            updateResizePreview();
        });

        resizeResetBtn.addEventListener('click', () => {
            resizeState.zoom = 1;
            const s = resizeState.baseScale;
            resizeState.x = (resizeState.displayW - resizeState.img.width * s) / 2;
            resizeState.y = (resizeState.displayH - resizeState.img.height * s) / 2;
            resizeSlider.value = 1;
            updateResizePreview();
        });

        resizeChangeImgBtn.addEventListener('click', () => {
            document.getElementById('resize-preview-container').style.display = 'none';
            document.getElementById('resize-drop-zone').style.display = 'flex';
            resizeState.img = null;
            fileStore.delete('resize-crop');
            document.querySelector('#resize-crop .convert-button').disabled = true;
        });

        // Watch for width/height input changes to update aspect ratio
        ['targetWidth', 'targetHeight'].forEach(id => {
            const input = document.getElementById(id);
            if (input) {
                input.addEventListener('input', () => {
                    resizeState.targetW = parseInt(document.getElementById('targetWidth').value) || 1080;
                    resizeState.targetH = parseInt(document.getElementById('targetHeight').value) || 1080;
                    updateResizePreview();
                });
            }
        });

        // Debounced resize listener
        let resizeTimeout;
        window.addEventListener('resize', () => {
            if (resizeState.img && document.getElementById('resize-crop').classList.contains('active')) {
                clearTimeout(resizeTimeout);
                resizeTimeout = setTimeout(() => {
                    updateResizePreview();
                }, 150);
            }
        });

        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');

        // --- Image Filter Editor Logic ---
        let filterImg = null;
        let activePreset = 'none';
        let isRendering = false;
        
        const filterCanvas = document.getElementById('filter-canvas');
        const filterCtx = filterCanvas ? filterCanvas.getContext('2d') : null;
        const filterContainer = document.getElementById('filter-canvas-container');

        const transformState = {
            zoom: 1,
            rotation: 0,
            panX: 0,
            panY: 0,
            ratio: 'original',
            isDragging: false,
            lastX: 0,
            lastY: 0,
            pinchDist: 0
        };

        function scheduleRender() {
            if (isRendering) return;
            isRendering = true;
            requestAnimationFrame(() => {
                renderFilterCanvas();
                isRendering = false;
            });
        }

        function renderFilterCanvas() {
            if (!filterImg || !filterCtx) return;

            const b = document.getElementById('f-brightness').value;
            const c = document.getElementById('f-contrast').value;
            const s = document.getElementById('f-saturation').value;
            const bl = document.getElementById('f-blur').value;
            const v = document.getElementById('f-vignette').value;
            const g = document.getElementById('f-grain').value;
            const zoom = document.getElementById('f-zoom').value / 100;
            const rot = document.getElementById('f-rotation').value;

            document.getElementById('val-brightness').textContent = b + '%';
            document.getElementById('val-contrast').textContent = c + '%';
            document.getElementById('val-saturation').textContent = s + '%';
            document.getElementById('val-blur').textContent = bl + 'px';
            document.getElementById('val-vignette').textContent = v + '%';
            document.getElementById('val-grain').textContent = g + '%';
            document.getElementById('val-zoom').textContent = Math.round(zoom * 100) + '%';
            document.getElementById('val-rotation').textContent = rot + '¬∞';

            // Set canvas resolution based on aspect ratio
            const containerW = filterContainer.clientWidth;
            const containerH = filterContainer.clientHeight;
            filterCanvas.width = containerW * 2; // Supersampling
            filterCanvas.height = containerH * 2;
            filterCanvas.style.width = containerW + 'px';
            filterCanvas.style.height = containerH + 'px';

            filterCtx.clearRect(0, 0, filterCanvas.width, filterCanvas.height);
            
            // Build Transformation Matrix
            filterCtx.save();
            filterCtx.translate(filterCanvas.width / 2 + transformState.panX * 2, filterCanvas.height / 2 + transformState.panY * 2);
            filterCtx.rotate((rot * Math.PI) / 180);
            filterCtx.scale(zoom, zoom);
            
            // Apply Image Filters
            let filterString = `brightness(${b}%) contrast(${c}%) saturate(${s}%) blur(${bl}px)`;
            const presetData = filterPresets[activePreset];
            if (presetData && presetData.tint) filterString += ` ${presetData.tint}`;
            filterCtx.filter = filterString;

            // Draw centered
            const drawW = filterImg.width;
            const drawH = filterImg.height;
            filterCtx.drawImage(filterImg, -drawW / 2, -drawH / 2, drawW, drawH);
            filterCtx.restore();

            // Overlays (Vignette & Grain)
            if (v > 0) {
                const grad = filterCtx.createRadialGradient(filterCanvas.width/2, filterCanvas.height/2, 0, filterCanvas.width/2, filterCanvas.height/2, Math.max(filterCanvas.width, filterCanvas.height)/1.4);
                grad.addColorStop(0, 'rgba(0,0,0,0)');
                grad.addColorStop(1, `rgba(0,0,0,${v/120})`);
                filterCtx.fillStyle = grad;
                filterCtx.fillRect(0, 0, filterCanvas.width, filterCanvas.height);
            }
            if (g > 0) {
                filterCtx.globalCompositeOperation = 'overlay';
                filterCtx.globalAlpha = g / 150;
                const grainCanvas = document.createElement('canvas');
                grainCanvas.width = 128; grainCanvas.height = 128;
                const gCtx = grainCanvas.getContext('2d');
                const gData = gCtx.createImageData(128, 128);
                for(let i=0; i<gData.data.length; i+=4) {
                    const val = Math.random() * 255;
                    gData.data[i] = gData.data[i+1] = gData.data[i+2] = val;
                    gData.data[i+3] = 255;
                }
                gCtx.putImageData(gData, 0, 0);
                filterCtx.fillStyle = filterCtx.createPattern(grainCanvas, 'repeat');
                filterCtx.fillRect(0, 0, filterCanvas.width, filterCanvas.height);
                filterCtx.globalCompositeOperation = 'source-over';
                filterCtx.globalAlpha = 1.0;
            }
        }

        // Pointer Events for Pan & Zoom
        if (filterContainer) {
            filterContainer.addEventListener('pointerdown', e => {
                transformState.isDragging = true;
                transformState.lastX = e.clientX;
                transformState.lastY = e.clientY;
                filterContainer.setPointerCapture(e.pointerId);
            });

            filterContainer.addEventListener('pointermove', e => {
                if (!transformState.isDragging) return;
                const dx = e.clientX - transformState.lastX;
                const dy = e.clientY - transformState.lastY;
                transformState.panX += dx;
                transformState.panY += dy;
                transformState.lastX = e.clientX;
                transformState.lastY = e.clientY;
                scheduleRender();
            });

            filterContainer.addEventListener('pointerup', () => transformState.isDragging = false);

            filterContainer.addEventListener('wheel', e => {
                e.preventDefault();
                const delta = e.deltaY > 0 ? 0.9 : 1.1;
                const slider = document.getElementById('f-zoom');
                slider.value = Math.max(10, Math.min(300, slider.value * delta));
                scheduleRender();
            }, { passive: false });
        }

        const filterPresets = {
            none: { b: 100, c: 100, s: 100, bl: 0, v: 0, g: 0 },
            clean: { b: 110, c: 115, s: 105, bl: 0, v: 0, g: 0 },
            warm: { b: 100, c: 100, s: 120, bl: 0, v: 0, g: 0, tint: 'sepia(0.25) hue-rotate(-10deg)' },
            cool: { b: 100, c: 105, s: 115, bl: 0, v: 0, g: 0, tint: 'hue-rotate(10deg) saturate(1.2)' },
            vintage: { b: 95, c: 90, s: 80, bl: 0, v: 25, g: 15, tint: 'sepia(0.5)' },
            film: { b: 105, c: 110, s: 85, bl: 0, v: 20, g: 25, tint: 'contrast(1.1) brightness(0.95)' },
            punchy: { b: 100, c: 140, s: 140, bl: 0, v: 10, g: 0 },
            glow: { b: 125, c: 95, s: 110, bl: 0.8, v: 0, g: 0 },
            bw: { b: 100, c: 120, s: 0, bl: 0, v: 15, g: 5 },
            sepia: { b: 100, c: 100, s: 100, bl: 0, v: 20, g: 0, tint: 'sepia(1)' },
            dramatic: { b: 90, c: 160, s: 40, bl: 0, v: 35, g: 0 },
            moody: { b: 75, c: 145, s: 70, bl: 0, v: 45, g: 15 }
        };

        function initFilterPreview(file) {
            if (file.size > 10 * 1024 * 1024) {
                alert("File too large. Maximum size is 10MB.");
                return;
            }
            const reader = new FileReader();
            reader.onload = (e) => {
                const img = new Image();
                img.onload = () => {
                    filterImg = img;
                    document.getElementById('filter-upload-stage').style.display = 'none';
                    document.getElementById('filter-editor-stage').style.display = 'block';
                    resetFilters();
                };
                img.src = e.target.result;
            };
            reader.readAsDataURL(file);
        }

        function resetFilters() {
            activePreset = 'none';
            document.querySelectorAll('.preset-btn').forEach(b => b.classList.toggle('active', b.dataset.preset === 'none'));
            ['f-brightness','f-contrast','f-saturation'].forEach(id => document.getElementById(id).value = 100);
            ['f-blur','f-vignette','f-grain','f-rotation'].forEach(id => document.getElementById(id).value = 0);
            
            if (filterImg && filterContainer) {
                const containerW = filterContainer.clientWidth || 800;
                const containerH = filterContainer.clientHeight || 600;
                const scale = Math.min(containerW / filterImg.width, containerH / filterImg.height);
                document.getElementById('f-zoom').value = Math.round(scale * 100);
            } else {
                document.getElementById('f-zoom').value = 100;
            }
            
            transformState.panX = 0; transformState.panY = 0;
            scheduleRender();
        }

        // --- End Filter Logic ---

        tabButtons.forEach(button => {
            button.addEventListener('click', async () => {
                const tabId = button.dataset.tab;
                tabButtons.forEach(btn => btn.classList.remove('active'));
                button.classList.add('active');
                tabContents.forEach(content => content.classList.toggle('active', content.id === tabId));
                
                const currentFiles = fileStore.get(tabId);
                updateSelectedFilesDisplay(document.getElementById(tabId), currentFiles);
            });
        });

        tabContents.forEach(tab => {
            const dropArea = tab.querySelector('.drop-zone');
            const fileInput = tab.querySelector('.file-input');
            const convertButton = tab.querySelector('.convert-button');
            const tabId = tab.id;

            if (!dropArea || !fileInput) return;

            dropArea.addEventListener('click', () => fileInput.click());
            fileInput.addEventListener('change', () => handleFiles(fileInput.files));
            
            ['dragover', 'dragleave', 'drop'].forEach(evt => {
                dropArea.addEventListener(evt, e => {
                    e.preventDefault(); e.stopPropagation();
                    if (evt === 'dragover') dropArea.classList.add('dragover');
                    if (evt === 'dragleave' || evt === 'drop') dropArea.classList.remove('dragover');
                    if (evt === 'drop') handleFiles(e.dataTransfer.files);
                });
            });
            
            function handleFiles(files) {
                if (files.length > 0) {
                    fileStore.set(tabId, files);
                    updateSelectedFilesDisplay(tab, files);
                    if (convertButton) convertButton.disabled = false;
                    
                    // Palette tab auto-execution
                    if (tabId === 'palette') {
                        executeConversion('palette', files);
                    }
                    // Resize & Crop preview initialization
                    if (tabId === 'resize-crop') {
                        initResizePreview(files[0]);
                    }
                    // Filter tab initialization
                    if (tabId === 'filter') {
                        initFilterPreview(files[0]);
                    }
                }
            }

            if (convertButton) {
                convertButton.addEventListener('click', e => {
                    e.stopPropagation();
                    const files = fileStore.get(tabId);
                    if (files) executeConversion(tabId, files);
                });
            }
            
            const qualitySlider = tab.querySelector('input[type="range"]');
            if (qualitySlider) {
                const qValue = tab.querySelector('.quality-value');
                qualitySlider.addEventListener('input', e => { if (qValue) qValue.textContent = e.target.value; });
            }
        });

        const compressTab = document.getElementById('compress');
        compressTab.querySelectorAll('.preset-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                compressTab.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                currentTargetSize = parseInt(btn.dataset.target);
                const qInput = compressTab.querySelector('#compress-quality');
                qInput.disabled = currentTargetSize > 0;
                compressTab.querySelector('.quality-value').textContent = currentTargetSize > 0 ? 'Auto' : qInput.value;
            });
        });

        // Event Listeners for Filters
        document.querySelectorAll('.preset-btn').forEach(btn => {
            if (btn.dataset.preset) {
                btn.addEventListener('click', () => {
                    activePreset = btn.dataset.preset;
                    document.querySelectorAll('.preset-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    const p = filterPresets[activePreset];
                    if (p) {
                        document.getElementById('f-brightness').value = p.b;
                        document.getElementById('f-contrast').value = p.c;
                        document.getElementById('f-saturation').value = p.s;
                        document.getElementById('f-blur').value = p.bl;
                        document.getElementById('f-vignette').value = p.v;
                        document.getElementById('f-grain').value = p.g;
                        scheduleRender();
                    }
                });
            }
        });

        ['f-brightness', 'f-contrast', 'f-saturation', 'f-blur', 'f-vignette', 'f-grain', 'f-zoom', 'f-rotation'].forEach(id => {
            const el = document.getElementById(id);
            if (el) el.addEventListener('input', scheduleRender);
        });

        const fRatio = document.getElementById('f-ratio');
        if (fRatio) {
            fRatio.addEventListener('change', () => {
                const val = fRatio.value;
                filterContainer.className = val === 'original' ? '' : `ratio-${val.replace(':', '-')}`;
                scheduleRender();
            });
        }

        document.getElementById('f-rot-left')?.addEventListener('click', () => {
            const el = document.getElementById('f-rotation');
            el.value = (parseInt(el.value) - 90);
            if (el.value < -180) el.value = parseInt(el.value) + 360;
            scheduleRender();
        });

        document.getElementById('f-rot-right')?.addEventListener('click', () => {
            const el = document.getElementById('f-rotation');
            el.value = (parseInt(el.value) + 90);
            if (el.value > 180) el.value = parseInt(el.value) - 360;
            scheduleRender();
        });

        document.getElementById('f-fit')?.addEventListener('click', () => {
            if (!filterImg) return;
            const containerW = filterContainer.clientWidth;
            const containerH = filterContainer.clientHeight;
            const scale = Math.min(containerW / filterImg.width, containerH / filterImg.height);
            document.getElementById('f-zoom').value = Math.round(scale * 100);
            transformState.panX = 0; transformState.panY = 0;
            scheduleRender();
        });

        document.getElementById('f-center')?.addEventListener('click', () => {
            transformState.panX = 0; transformState.panY = 0;
            scheduleRender();
        });

        const frBtn = document.getElementById('filter-reset-btn');
        if (frBtn) frBtn.addEventListener('click', resetFilters);
        
        const fdBtn = document.getElementById('filter-download-btn');
        if (fdBtn) {
            fdBtn.addEventListener('click', () => {
                const link = document.createElement('a');
                link.download = `filtered_${Date.now()}.png`;
                link.href = filterCanvas.toDataURL('image/png', 1.0);
                link.click();
            });
        }

        async function executeConversion(tabId, files) {
            const tab = document.getElementById(tabId);
            setInProgress(tab, true);
            const resultsContainer = tab.querySelector('.results');
            if (resultsContainer) resultsContainer.innerHTML = '';

            try {
                let results = [];
                switch (tabId) {
                    case 'heic-to-jpg': results = await convertHeic(files, tab); break;
                    case 'webp-to-jpg': results = await convertCanvas(files, tab, 'image/jpeg', '.jpg'); break;
                    case 'png-to-jpg': results = await convertCanvas(files, tab, 'image/jpeg', '.jpg', tab.querySelector('#png-to-jpg-quality').value); break;
                    case 'jpg-to-png': results = await convertCanvas(files, tab, 'image/png', '.png'); break;
                    case 'compress': results = await convertCanvas(files, tab, 'image/jpeg', '.jpg', 0.8); break; // Basic compression
                    case 'jpg-to-pdf': results = await convertPdf(files, tab); break;
                    case 'favicon': results = await convertFavicon(files[0], tab); break;
                    case 'resize-crop': results = [await processResizeCrop(files[0])]; break;
                    case 'exif': results = [await processExifRemover(files[0])]; break;
                    case 'palette': await processPalette(files[0]); break;
                }
                if (results && results.length > 0) displayResults(tab, results);
            } catch (e) {
                alert('Error: ' + e.message);
            } finally {
                setInProgress(tab, false);
            }
        }

        async function convertHeic(files, tab) {
            const res = [];
            const bar = tab.querySelector('.progress-fill');
            for (let i = 0; i < files.length; i++) {
                bar.style.width = (i/files.length)*100 + '%';
                const blob = await heic2any({ blob: files[i], toType: 'image/jpeg', quality: 0.9 });
                res.push({ name: files[i].name.replace(/\.[^/.]+$/, "") + '.jpg', blob, originalSize: files[i].size });
            }
            return res;
        }

        async function convertCanvas(files, tab, format, ext, quality) {
            const res = [];
            const bar = tab.querySelector('.progress-fill');
            for (let i = 0; i < files.length; i++) {
                bar.style.width = (i/files.length)*100 + '%';
                const blob = await new Promise(r => {
                    const img = new Image();
                    img.onload = () => {
                        const c = document.createElement('canvas');
                        c.width = img.width; c.height = img.height;
                        c.getContext('2d').drawImage(img, 0, 0);
                        c.toBlob(r, format, parseFloat(quality) || 0.92);
                    };
                    img.src = URL.createObjectURL(files[i]);
                });
                res.push({ name: files[i].name.replace(/\.[^/.]+$/, "") + ext, blob, originalSize: files[i].size });
            }
            return res;
        }

        async function preprocessForOCR(file) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.onload = () => {
                    const canvas = document.createElement('canvas');
                    canvas.width = img.width; canvas.height = img.height;
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0);
                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    const data = imageData.data;
                    const isGrayscale = document.getElementById('ocr-grayscale').checked;
                    const isContrast = document.getElementById('ocr-contrast').checked;
                    const threshold = parseInt(document.getElementById('ocr-threshold').value);
                    for (let i = 0; i < data.length; i += 4) {
                        let r = data[i], g = data[i+1], b = data[i+2];
                        if (isGrayscale || isContrast) {
                            let gray = 0.299 * r + 0.587 * g + 0.114 * b;
                            if (isContrast) gray = (gray - 128) * 1.5 + 128;
                            if (threshold > 0) gray = gray >= threshold ? 255 : 0;
                            data[i] = data[i+1] = data[i+2] = gray;
                        }
                    }
                    ctx.putImageData(imageData, 0, 0);
                    resolve(canvas);
                };
                img.onerror = reject;
                img.src = URL.createObjectURL(file);
            });
        }

        async function checkOcrAssets() {
            const assets = [
                { name: "Worker Script", url: "/ocr/worker.min.js" },
                { name: "WASM Core", url: "/ocr/tesseract-core.wasm.js" },
                { name: "Language Data (English)", url: "/ocr/tessdata/eng.traineddata.gz" },
                { name: "Language Data (Korean)", url: "/ocr/tessdata/kor.traineddata.gz" }
            ];
            const panel = document.getElementById('ocr-diagnostics');
            const list = document.getElementById('diag-list');
            panel.style.display = 'block';
            list.innerHTML = '';
            
            let allOk = true;
            
            // Diagnostics Text
            const libLoad = document.createElement('div');
            libLoad.className = 'diag-item';
            const isLibLoaded = typeof Tesseract !== 'undefined';
            libLoad.innerHTML = `<span>Tesseract Library Loaded</span><span class="diag-status" style="color: ${isLibLoaded ? 'var(--brand-success)' : 'var(--brand-accent)'}">${isLibLoaded ? '‚úÖ' : '‚ùå'}</span>`;
            list.appendChild(libLoad);
            if (!isLibLoaded) allOk = false;

            for (const asset of assets) {
                const item = document.createElement('div');
                item.className = 'diag-item';
                try {
                    const res = await fetch(asset.url, { method: 'HEAD' });
                    const status = res.status;
                    const ok = res.ok;
                    if (!ok) allOk = false;
                    item.innerHTML = `<span>${asset.name}</span><span class="diag-status" style="color: ${ok ? 'var(--brand-success)' : 'var(--brand-accent)'}">${ok ? '‚úÖ' : '‚ùå'} (HTTP ${status})</span>`;
                } catch (e) {
                    allOk = false;
                    item.innerHTML = `<span>${asset.name}</span><span class="diag-status" style="color: var(--brand-accent)">‚ùå (Error: ${e.message})</span>`;
                }
                list.appendChild(item);
            }
            return allOk;
        }

        function keepEnglishOnly(text) {
            if (!text) return "";
            return text
                .replace(/[\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uAC00-\uD7A3\uD7B0-\uD7FF]/g, "")
                .replace(/[^\x09\x0A\x0D\x20-\x7E]/g, "") // remove non-ASCII noise
                .replace(/[ \t]+/g, " ")
                .replace(/\n{3,}/g, "\n\n")
                .trim();
        }

        async function initOcrEngineOnce() {
            if (ocrWorker) return ocrWorker;
            const output = document.getElementById('ocrResult');
            const bar = document.getElementById('ocr-progress-bar');
            if (output) output.value = "Initializing OCR engine...";
            
            try {
                if (typeof Tesseract === 'undefined') throw new Error("Tesseract.js not loaded. Check script import order.");
                
                const timeoutSeconds = 60;
                const workerOptions = {
                    workerPath: "/ocr/worker.min.js",
                    corePath: "/ocr/tesseract-core.wasm.js",
                    langPath: "/ocr/tessdata",
                    logger: m => {
                        console.log(m);
                        const progress = Math.round((m.progress || 0) * 100);
                        
                        // Update diagnostics panel progress
                        const diagList = document.getElementById('diag-list');
                        if (diagList) {
                            let progressItem = diagList.querySelector('.diag-progress');
                            if (!progressItem) {
                                progressItem = document.createElement('div');
                                progressItem.className = 'diag-item diag-progress';
                                diagList.appendChild(progressItem);
                            }
                            progressItem.innerHTML = `<span>Last Action: ${m.status}</span><span class="diag-status">${progress}%</span>`;
                        }

                        if (m.status === 'recognizing text') {
                            if (bar) bar.style.width = progress + '%';
                            if (output) output.value = `Recognizing text... ${progress}%`;
                        } else {
                            if (output && !output.value.includes('OCR engine ready')) {
                                output.value = `${m.status}... ${progress}%`;
                            }
                        }
                    }
                };

                // Create worker with explicit language (English Only)
                const worker = await Tesseract.createWorker(['eng'], 1, workerOptions);
                
                // 60s Timeout for initialization (Tesseract.createWorker is async)
                const timeoutPromise = new Promise((_, reject) => 
                    setTimeout(() => reject(new Error(`OCR engine initialization timed out (${timeoutSeconds}s)`)), timeoutSeconds * 1000)
                );

                ocrWorker = await Promise.race([Promise.resolve(worker), timeoutPromise]);
                if (output) output.value = "OCR engine ready.";
                return ocrWorker;
            } catch (error) {
                console.error('OCR Init Error:', error);
                if (output) output.value = `OCR Init Error: ${error.message}`;
                ocrWorker = null;
                throw error;
            }
        }

        async function performOCR(file, tab) {
            const bar = document.getElementById('ocr-progress-bar');
            const output = document.getElementById('ocrResult');
            const container = document.getElementById('ocr-progress-container');
            
            container.style.display = 'block';
            bar.style.width = '0%';
            output.value = 'Running diagnostics...';

            const assetsOk = await checkOcrAssets();
            if (!assetsOk) {
                output.value = "CRITICAL ERROR: One or more OCR assets are missing or inaccessible. Check diagnostics below.";
                return;
            }

            try {
                const canvas = await preprocessForOCR(file);
                const worker = await initOcrEngineOnce();
                
                const { data: { text } } = await worker.recognize(canvas);
                output.value = keepEnglishOnly(text) || 'No text found.';
            } catch (error) {
                console.error('OCR Error:', error);
                output.value = `OCR Error: ${error.message}. Please check diagnostics below.`;
            }
        }

        async function processResizeCrop(file) {
            const { img, x, y, zoom, baseScale, targetW, targetH, displayW } = resizeState;
            if (!img) return;
            const format = document.getElementById('resize-format').value;
            
            // Ratio between target output pixels and preview display pixels
            const ratio = targetW / displayW;
            const finalScale = baseScale * zoom * ratio;
            const finalX = x * ratio;
            const finalY = y * ratio;

            return new Promise((resolve) => {
                const canvas = document.createElement('canvas');
                canvas.width = targetW;
                canvas.height = targetH;
                const ctx = canvas.getContext('2d');
                
                ctx.imageSmoothingEnabled = true;
                ctx.imageSmoothingQuality = 'high';
                
                // Draw background (black) for any potential gaps (though clamping should prevent them)
                ctx.fillStyle = '#000';
                ctx.fillRect(0, 0, targetW, targetH);
                
                ctx.drawImage(img, finalX, finalY, img.width * finalScale, img.height * finalScale);
                
                canvas.toBlob((blob) => {
                    resolve({ 
                        name: `resized_${file.name.replace(/\.[^/.]+$/, "")}.${format === 'image/png' ? 'png' : 'jpg'}`, 
                        blob, 
                        originalSize: file.size 
                    });
                }, format, format === 'image/jpeg' ? 0.95 : undefined);
            });
        }

        async function processExifRemover(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const cleanDataUrl = piexif.remove(e.target.result);
                        fetch(cleanDataUrl).then(res => res.blob()).then(blob => {
                            resolve({ 
                                name: `cleaned_${file.name}`, 
                                blob, 
                                originalSize: file.size,
                                noPreview: false 
                            });
                        });
                    } catch (err) {
                        reject(new Error("Failed to strip metadata. Ensure it's a valid JPG."));
                    }
                };
                reader.readAsDataURL(file);
            });
        }

        let paletteHistory = [];
        const MAX_HISTORY = 6;

        async function processPalette(file) {
            const workspace = document.getElementById('palette-workspace');
            const canvas = document.getElementById('palette-canvas');
            const ctx = canvas.getContext('2d', { willReadFrequently: true });
            const loupe = document.getElementById('loupe');
            const loupeCanvas = document.getElementById('loupe-canvas');
            const loupeCtx = loupeCanvas.getContext('2d');
            const loupeHex = document.getElementById('loupe-hex');
            const selectedHex = document.getElementById('selected-hex');
            const colorChip = document.getElementById('current-color-chip');
            const edContainer = document.getElementById('eyedropper-container');
            
            workspace.style.display = 'block';
            
            if (window.EyeDropper) {
                edContainer.style.display = 'block';
                document.getElementById('eyedropper-btn').onclick = async () => {
                    try {
                        const result = await new EyeDropper().open();
                        window.copyHex(result.sRGBHex);
                        addToHistory(result.sRGBHex);
                    } catch (e) {}
                };
            }

            const img = new Image();
            img.src = URL.createObjectURL(file);
            await new Promise(r => img.onload = r);

            const maxW = 1200;
            let w = img.width, h = img.height;
            if (w > maxW) { h = (maxW / w) * h; w = maxW; }
            canvas.width = w; canvas.height = h;
            ctx.drawImage(img, 0, 0, w, h);

            const getPixelColor = (e) => {
                const rect = canvas.getBoundingClientRect();
                // Client relative coordinates to Canvas resolution coordinates
                let x = (e.clientX - rect.left) * (canvas.width / rect.width);
                let y = (e.clientY - rect.top) * (canvas.height / rect.height);
                
                // Clamp coordinates to image bounds
                x = Math.max(0, Math.min(canvas.width - 1, x));
                y = Math.max(0, Math.min(canvas.height - 1, y));
                
                let r, g, b;
                if (e.shiftKey) {
                    // 5x5 average color calculation with boundary protection
                    let sr = 0, sg = 0, sb = 0, count = 0;
                    const size = 5;
                    const half = Math.floor(size / 2);
                    const ix = Math.max(0, Math.min(canvas.width - size, Math.floor(x) - half));
                    const iy = Math.max(0, Math.min(canvas.height - size, Math.floor(y) - half));
                    
                    const data = ctx.getImageData(ix, iy, size, size).data;
                    for(let i=0; i<data.length; i+=4) {
                        sr += data[i]; sg += data[i+1]; sb += data[i+2];
                        count++;
                    }
                    r = sr/count; g = sg/count; b = sb/count;
                } else {
                    const data = ctx.getImageData(Math.floor(x), Math.floor(y), 1, 1).data;
                    r = data[0]; g = data[1]; b = data[2];
                }

                const hex = `#${((1 << 24) + (Math.round(r) << 16) + (Math.round(g) << 8) + Math.round(b)).toString(16).slice(1).toUpperCase()}`;
                
                // Loupe rendering
                const zoom = 8;
                const loupeSize = loupeCanvas.width / zoom;
                loupeCtx.imageSmoothingEnabled = false;
                loupeCtx.clearRect(0, 0, loupeCanvas.width, loupeCanvas.height);
                loupeCtx.drawImage(canvas, x - loupeSize/2, y - loupeSize/2, loupeSize, loupeSize, 0, 0, loupeCanvas.width, loupeCanvas.height);
                
                return { hex, displayX: e.clientX - rect.left, displayY: e.clientY - rect.top };
            };

            const handlePointer = (e) => {
                const { hex, displayX, displayY } = getPixelColor(e);
                loupe.style.display = 'block';
                loupe.style.left = `${displayX}px`;
                loupe.style.top = `${displayY}px`;
                
                selectedHex.value = hex;
                colorChip.style.background = hex;
                loupeHex.textContent = hex + (e.shiftKey ? ' (Avg)' : '');
                
                if (e.type === 'pointerdown') {
                    window.copyHex(hex);
                    addToHistory(hex);
                }
            };

            canvas.onpointermove = handlePointer;
            canvas.onpointerdown = handlePointer;
            canvas.onpointerleave = () => loupe.style.display = 'none';
        }

        function addToHistory(hex) {
            if (paletteHistory[0] === hex) return;
            paletteHistory = [hex, ...paletteHistory.filter(h => h !== hex)].slice(0, MAX_HISTORY);
            renderHistory();
        }

        function renderHistory() {
            const container = document.getElementById('color-history');
            container.innerHTML = paletteHistory.map(hex => `
                <div class="history-chip" style="background: ${hex}" title="${hex}" onclick="window.copyHex('${hex}')"></div>
            `).join('');
        }

        window.copyHex = (hex) => {
            navigator.clipboard.writeText(hex).then(() => {
                const btn = document.getElementById('copy-hex-btn');
                const originalText = btn.textContent;
                btn.textContent = 'Copied!';
                btn.style.background = 'var(--brand-success)';
                setTimeout(() => {
                    btn.textContent = originalText;
                    btn.style.background = '';
                }, 1000);
            });
            document.getElementById('selected-hex').value = hex;
            document.getElementById('current-color-chip').style.background = hex;
        }

        document.getElementById('copy-hex-btn').addEventListener('click', () => {
            const hex = document.getElementById('selected-hex').value;
            if (hex !== "#------") window.copyHex(hex);
        });

        // Grammar Check & Enhancement Logic
        const correctedArea = document.getElementById('correctedResult');
        const previewArea = document.getElementById('ocr-preview-area');
        const autoFixBtn = document.getElementById('ocr-auto-fix');
        const applyFixesBtn = document.getElementById('ocr-apply-fixes');
        const copyCorrectedBtn = document.getElementById('ocr-copy-corrected');
        let lastMatches = [];

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function makeDiffHtml(original, matches) {
            let html = "";
            let lastIdx = 0;
            // Sort matches by offset ascending
            const sortedMatches = [...matches].sort((a, b) => a.offset - b.offset);
            
            sortedMatches.forEach(match => {
                html += escapeHtml(original.substring(lastIdx, match.offset));
                const replacement = (match.replacements && match.replacements.length > 0) 
                    ? match.replacements[0].value 
                    : original.substring(match.offset, match.offset + match.length);
                
                html += `<span class="diff-highlight" title="${escapeHtml(match.message)}">${escapeHtml(replacement)}</span>`;
                lastIdx = match.offset + match.length;
            });
            html += escapeHtml(original.substring(lastIdx));
            return html;
        }

        async function checkGrammar() {
            const text = ocrOutput.value;
            if (!text || text.length < 2) return;
            
            const panel = document.getElementById('grammar-issues');
            const list = document.getElementById('issues-list');
            panel.style.display = 'block';
            list.innerHTML = '<p style="color: var(--brand-primary); font-weight: 700;">üîç Analyzing text with AI Engine...</p>';
            
            // Automatic language detection
            const isKorean = /[„Ñ±-„Öé|„Öè-„Ö£|Í∞Ä-Ìû£]/.test(text);
            const lang = isKorean ? 'ko' : 'en-US';

            try {
                // Using a slightly more robust fetch approach
                const response = await fetch('https://api.languagetool.org/v2/check', {
                    method: 'POST',
                    headers: { 
                        'Content-Type': 'application/x-www-form-urlencoded',
                        'Accept': 'application/json'
                    },
                    body: `language=${lang}&text=${encodeURIComponent(text)}`
                });

                if (!response.ok) {
                    throw new Error(`Server responded with ${response.status}`);
                }

                const data = await response.json();
                lastMatches = data.matches || [];
                
                list.innerHTML = '';
                if (lastMatches.length === 0) {
                    list.innerHTML = '<p style="color: var(--brand-success); font-weight: 800;">‚ú® No issues detected! Text looks clean.</p>';
                    previewArea.style.display = 'none';
                    autoFixBtn.style.display = 'none';
                    applyFixesBtn.style.display = 'none';
                    copyCorrectedBtn.style.display = 'none';
                } else {
                    // Show Comparison View
                    previewArea.style.display = 'block';
                    autoFixBtn.style.display = 'inline-block';
                    applyFixesBtn.style.display = 'inline-block';
                    copyCorrectedBtn.style.display = 'inline-block';
                    
                    correctedArea.innerHTML = makeDiffHtml(text, lastMatches);

                    lastMatches.forEach((match, idx) => {
                        const div = document.createElement('div');
                        div.className = 'issue-item';
                        div.innerHTML = `
                            <p class="issue-message"><strong>[${match.rule.category.name}]</strong> ${match.message}</p>
                            <p style="font-size: 0.85rem; margin-bottom: 0.5rem; opacity: 0.8;">Context: "...${escapeHtml(text.substring(Math.max(0, match.offset-20), match.offset))}<b style="color:var(--brand-accent)">${escapeHtml(text.substring(match.offset, match.offset + match.length))}</b>${escapeHtml(text.substring(match.offset + match.length, match.offset + match.length + 20))}..."</p>
                            <div class="suggestions">
                                ${match.replacements.slice(0, 3).map(rep => `<button class="suggestion-btn" onclick="window.applySingleFix(${idx}, '${rep.value.replace(/'/g, "\\'")}')">${rep.value}</button>`).join('')}
                            </div>
                        `;
                        list.appendChild(div);
                    });
                }
            } catch (e) {
                console.error('Grammar Engine Error:', e);
                list.innerHTML = `<div style="color: var(--brand-accent); padding: 1rem; border: 1px solid var(--brand-accent); border-radius: 12px; background: rgba(244, 63, 94, 0.05);">
                    <p style="font-weight: 800; margin-bottom: 0.5rem;">‚ö†Ô∏è Engine Connectivity Issue</p>
                    <p style="font-size: 0.9rem; opacity: 0.9;">We're having trouble reaching the grammar engine. This can happen due to high traffic or network restrictions.</p>
                    <button class="btn-primary" onclick="checkGrammar()" style="margin-top: 1rem; padding: 0.5rem 1rem; font-size: 0.8rem;">Try Again</button>
                </div>`;
            }
        }

        document.getElementById('ocr-check-grammar').addEventListener('click', checkGrammar);

        window.applySingleFix = (matchIdx, replacement) => {
            const match = lastMatches[matchIdx];
            const text = ocrOutput.value;
            ocrOutput.value = text.substring(0, match.offset) + replacement + text.substring(match.offset + match.length);
            checkGrammar(); // Refresh
        };

        autoFixBtn.addEventListener('click', () => {
            let text = ocrOutput.value;
            // Apply from back to front to preserve offsets
            const sorted = [...lastMatches].sort((a, b) => b.offset - a.offset);
            sorted.forEach(match => {
                if (match.replacements && match.replacements.length > 0) {
                    const rep = match.replacements[0].value;
                    text = text.substring(0, match.offset) + rep + text.substring(match.offset + match.length);
                }
            });
            ocrOutput.value = text;
            checkGrammar();
        });

        applyFixesBtn.addEventListener('click', () => {
            // The text is already in the preview, we just update the original if they haven't auto-fixed yet
            // But usually "Apply" means take the corrected version (div content) and put it in textarea
            ocrOutput.value = correctedArea.innerText;
            previewArea.style.display = 'none';
            autoFixBtn.style.display = 'none';
            applyFixesBtn.style.display = 'none';
            copyCorrectedBtn.style.display = 'none';
            alert('Corrected text applied to original OCR result.');
        });

        copyCorrectedBtn.addEventListener('click', () => {
            navigator.clipboard.writeText(correctedArea.innerText);
            alert('Corrected text copied to clipboard!');
        });

        document.getElementById('apply-all-fixes').addEventListener('click', () => {
            let text = ocrOutput.value;
            // 1. Double spaces
            text = text.replace(/\s\s+/g, ' ');
            // 2. Korean specific cleanup (if applicable)
            if (/[„Ñ±-„Öé|„Öè-„Ö£|Í∞Ä-Ìû£]/.test(text)) {
                text = text.replace(/([Í∞Ä-Ìû£])\s+([,.!?])/g, '$1$2'); // Remove space before punctuation
            } else {
                // English punctuation cleanup
                text = text.replace(/\s([,.!?;:])/g, '$1');
                text = text.replace(/(^\s*|[.!?]\s+)([a-z])/g, (m, p1, p2) => p1 + p2.toUpperCase());
            }
            ocrOutput.value = text.trim();
            checkGrammar();
        });

        async function convertPdf(files, tab) {
            let pdf;
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const dataUrl = await new Promise(r => {
                    const reader = new FileReader();
                    reader.onload = e => r(e.target.result);
                    reader.readAsDataURL(file);
                });

                const img = new Image();
                await new Promise(r => { 
                    img.onload = r; 
                    img.src = dataUrl; 
                });

                const w = img.naturalWidth;
                const h = img.naturalHeight;
                const type = file.type.toLowerCase().includes('png') ? 'PNG' : 'JPEG';

                if (i === 0) {
                    pdf = new jsPDF({
                        unit: 'px',
                        format: [w, h],
                        orientation: w > h ? 'l' : 'p'
                    });
                } else {
                    pdf.addPage([w, h], w > h ? 'l' : 'p');
                }
                pdf.addImage(dataUrl, type, 0, 0, w, h);
            }
            return [{ name: 'merged-images.pdf', blob: pdf.output('blob'), originalSize: 0 }];
        }

        async function convertFavicon(file, tab) {
            const zip = new JSZip();
            const source = await new Promise(r => {
                const img = new Image(); img.onload = () => r(img);
                img.src = URL.createObjectURL(file);
            });
            for (const s of [16, 32, 48, 64]) {
                const c = document.createElement('canvas');
                c.width = c.height = s;
                c.getContext('2d').drawImage(source, 0, 0, s, s);
                const b = await new Promise(ok => c.toBlob(ok, 'image/png'));
                zip.file(`favicon-${s}x${s}.png`, b);
            }
            const blob = await zip.generateAsync({ type: 'blob' });
            return [{ name: 'favicon_pack.zip', blob, originalSize: file.size, noPreview: true }];
        }

        function displayResults(tab, data) {
            const container = tab.querySelector('.results');
            if (!container) return;
            if (data.length > 1) {
                const zip = new JSZip();
                data.forEach(r => zip.file(r.name, r.blob));
                zip.generateAsync({ type: 'blob' }).then(b => {
                    container.prepend(createResultCard({ name: 'all_files.zip', blob: b, originalSize: 0, noPreview: true }));
                });
            }
            data.forEach(r => container.appendChild(createResultCard(r)));
        }

        function createResultCard(res) {
            const div = document.createElement('div');
            div.className = 'result-card';
            const url = URL.createObjectURL(res.blob);
            const reduction = res.originalSize ? Math.round((1 - res.blob.size/res.originalSize)*100) : 0;
            div.innerHTML = `
                ${res.noPreview ? '' : `<img src="${url}" style="width: 60px; height: 60px; border-radius: 12px; object-fit: cover;">`}
                <div style="flex-grow: 1;">
                    <strong style="display:block; margin-bottom: 0.25rem;">${res.name}</strong>
                    <p style="font-size: 0.85rem; color: var(--text-sub);">${formatBytes(res.blob.size)} ${reduction > 0 ? `<span style="color: var(--brand-success); font-weight: 800;">(${reduction}% optimized)</span>` : ''}</p>
                </div>
                <a href="${url}" download="${res.name}" class="btn-primary" style="padding: 0.6rem 1.2rem; font-size: 0.85rem; box-shadow: none;">Download</a>
            `;
            return div;
        }

        function updateSelectedFilesDisplay(tab, files) {
            const p = tab.querySelector('.drop-zone p:first-child');
            if (!p) return;
            p.textContent = (!files || files.length === 0) ? `Drop ${tab.id === 'ocr' ? 'image' : 'files'} here` : (files.length === 1 ? `Selected: ${files[0].name}` : `${files.length} files selected`);
        }

        function setInProgress(tab, busy) {
            const btn = tab.querySelector('.convert-button');
            const bar = tab.querySelector('.progress-wrapper');
            if (btn) btn.disabled = busy;
            if (bar) bar.style.display = busy ? 'block' : 'none';
        }

        function formatBytes(b) {
            if (b === 0) return '0 B';
            const i = Math.floor(Math.log(b) / Math.log(1024));
            return (b / Math.pow(1024, i)).toFixed(2) * 1 + ' ' + ['B', 'KB', 'MB', 'GB'][i];
        }
    });
    </script>
</body>
</html>